Mad-Assembler v1.6.9beta by TeBe/Madteam
Source: D:\!Atari\getris2\grat\grat.asm
     1 				// GETRIS GRATULACJE v1.1
     2 				// CHANGES: 30.01.2006
     3
     4
     5 = 00,0000		pmBase  equ $0000
     6
     7 = 00,003F		scr48	equ %00111111	;screen 48b
     8 = 00,003E		scr40	equ %00111110	;screen 40b
     9 = 00,003D		scr32	equ %00111101	;screen 32b
    10
    11 = 00,0014		cloc	equ $0014	;(1)
    12 = 00,0000		byt2	equ $0000	;(1) <$0100
    13 = 00,0100		byt3	equ $0100	;(1) >$00FF
    14
    15 = 00,0080		ftmp	equ $80		;(2)
    16 = 00,0082		regA	equ ftmp+2	;(1)
    17 = 00,0083		regX	equ regA+1	;(1)
    18 = 00,0084		regY	equ regX+1	;(1)
    19 = 00,0085		zp_free	equ regY+1	;(1)
    20
    21 = 00,D000		hposp0	equ $D000
    22 = 00,D001		hposp1	equ $D001
    23 = 00,D002		hposp2	equ $D002
    24 = 00,D003		hposp3	equ $D003
    25 = 00,D004		hposm0	equ $D004
    26 = 00,D005		hposm1	equ $D005
    27 = 00,D006		hposm2	equ $D006
    28 = 00,D007		hposm3	equ $D007
    29 = 00,D008		sizep0	equ $D008
    30 = 00,D009		sizep1	equ $D009
    31 = 00,D00A		sizep2	equ $D00A
    32 = 00,D00B		sizep3	equ $D00B
    33 = 00,D00C		sizem	equ $D00C
    34
    35 = 00,D012		colpm0	equ $D012
    36 = 00,D013		colpm1	equ $D013
    37 = 00,D014		colpm2	equ $D014
    38 = 00,D015		colpm3	equ $D015
    39 = 00,D016		color0	equ $D016
    40 = 00,D017		color1	equ $D017
    41 = 00,D018		color2	equ $D018
    42 = 00,D019		color3	equ $D019
    43 = 00,D01A		colbak	equ $D01A
    44 = 00,D01B		gtictl	equ $D01B
    45
    46 = 00,D409		chbase	equ $D409
    47
    48 				;-- MAIN PROGRAM
    49 				; opt h-
    50 				 org $1000
    51
    52 				fnt
    53 FFFF> 00,1000-3360> 00 +	 ins 'grat.fnt',0,4096+46*8
    54
    55 00,2170			ant
    56 00,2170 70 70 70 C4 89 +	 dta d'ppp',$c4,a(scr)
    57 00,2176 04 84 84 84 84 +	 dta 4,$84,$84,$84,$84,4,4,4,4,$84,$84,$f0,2,$82,2,2
    58 00,2186 41 70 21		 dta $41,a(ant)
    59
    60
    61 00,2189			scr
    62 00,2189 01 02 03 04 05 +	 ins 'grat.scr',120,12*40
    63 00,2369 8F AE AF B0 B1 +	 ins 'grat.scr',120+12*40+40,4*40
    64
    65 00,2409			pmg
    66 00,2409 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    67 00,2415 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$20,$00,$00,$00,$20,$00,$00,$00
    68 00,2425 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$40,$80
    69 00,2435 80 04 08 28 00 +	 dta $80,$04,$08,$28,$00,$10,$00,$00,$C0,$08,$08,$04,$04,$00,$00,$08
    70 00,2445 C8 08 08 00 08 +	 dta $C8,$08,$08,$00,$08,$04,$08,$08,$00,$08,$08,$00,$08,$08,$08,$04
    71 00,2455 00 08 00 00 00 +	 dta $00,$08,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    72 00,2465 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$30,$30,$30,$30,$30,$30,$30,$30
    73 00,2475 30 30 30 30 30 +	 dta $30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30
    74 00,2485 30 30		 dta $30,$30
    75
    76 00,2487 00 00 80 80 00 +	 dta $00,$00,$80,$80,$00,$00,$00,$00,$00,$08,$00,$00
    77 00,2493 00 40 28 20 20 +	 dta $00,$40,$28,$20,$20,$30,$20,$10,$20,$21,$01,$01,$20,$20,$00,$08
    78 00,24A3 68 20 00 00 20 +	 dta $68,$20,$00,$00,$20,$24,$04,$00,$24,$24,$00,$04,$04,$04,$22,$60
    79 00,24B3 80 80 00 00 08 +	 dta $80,$80,$00,$00,$08,$08,$10,$10,$18,$10,$10,$90,$88,$00,$08,$00
    80 00,24C3 40 00 80 00 00 +	 dta $40,$00,$80,$00,$00,$80,$00,$40,$00,$00,$82,$00,$40,$00,$00,$88
    81 00,24D3 00 40 20 20 20 +	 dta $00,$40,$20,$20,$20,$20,$20,$00,$20,$40,$20,$60,$80,$C0,$80,$C0
    82 00,24E3 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
    83 00,24F3 FF FF FF FF FF +	 dta $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
    84 00,2503 FF FF		 dta $FF,$FF
    85
    86 00,2505 00 40 20 80 40 +	 dta $00,$40,$20,$80,$40,$00,$00,$40,$04,$08,$44,$00
    87 00,2511 24 04 08 04 2D +	 dta $24,$04,$08,$04,$2D,$21,$08,$10,$08,$08,$10,$10,$20,$24,$14,$30
    88 00,2521 00 24 10 10 02 +	 dta $00,$24,$10,$10,$02,$00,$10,$12,$00,$00,$12,$10,$00,$11,$22,$48
    89 00,2531 0A 10 24 68 10 +	 dta $0A,$10,$24,$68,$10,$A0,$50,$40,$7F,$00,$00,$00,$00,$00,$00,$00
    90 00,2541 7F 00 00 00 00 +	 dta $7F,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    91 00,2551 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    92 00,2561 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
    93 00,2571 FF FF FF FF FF +	 dta $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
    94 00,2581 FF FF		 dta $FF,$FF
    95
    96 00,2583 60 90 00 10 20 +	 dta $60,$90,$00,$10,$20,$80,$20,$8A,$20,$00,$44,$10
    97 00,258F A4 84 02 80 05 +	 dta $A4,$84,$02,$80,$05,$84,$01,$4A,$48,$42,$00,$08,$00,$10,$01,$14
    98 00,259F 10 04 14 40 00 +	 dta $10,$04,$14,$40,$00,$00,$48,$42,$08,$42,$0A,$02,$49,$90,$00,$04
    99 00,25AF 3F FF FF FF FF +	 dta $3F,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
   100 00,25BF FF DF DE A2 62 +	 dta $FF,$DF,$DE,$A2,$62,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   101 00,25CF 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   102 00,25DF 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   103 00,25EF 00 00 00 00 00 +	 dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   104 00,25FF 00 00		 dta $00,$00
   105
   106 00,2601			main
   107
   108 				;-- init PMG
   109 				 mva >pmBase $d407	;missiles and players data address
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2601 A9 00		 lda >PMBASE
     2 00,2603 8D 07 D4		 sta $D407
Source: D:\!Atari\getris2\grat\grat.asm
   110 				 mva #3 $d01d		;enable players and missiles
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2606 A9 03		 lda #3
     2 00,2608 8D 1D D0		 sta $D01D
Source: D:\!Atari\getris2\grat\grat.asm
   111
   112 00,260B 20 25 32		 jsr save_color
   113
   114 				 lda:cmp:req 20		;wait 1 frame
   114 00,260E A5 14		 lda 20		
   114 00,2610 C5 14		 cmp 20		
   114 00,2612 F0 FC		 req$2610 20		
   115
   116 00,2614 78		 sei			;stop interrups
   117 				 mva #0 $d40e		;stop all interrupts
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2615 A9 00		 lda #0
     2 00,2617 8D 0E D4		 sta $D40E
Source: D:\!Atari\getris2\grat\grat.asm
   118 				 mva #$fe $d301		;switch off ROM to get 16k more ram
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,261A A9 FE		 lda #$FE
     2 00,261C 8D 01 D3		 sta $D301
Source: D:\!Atari\getris2\grat\grat.asm
   119
   120
   121 				; clr pmg
   122 00,261F A0 00		 ldy #0
   123 00,2621 98		 tya
   124 00,2622			clr
   125 				.rept 5
   126 				 sta pmBase+$300+.r*$100,y
   127 				.endr
Source: REPT
   126 00,2622 99 00 03		 sta pmBase+$300+.r*$100,y
   126 00,2625 99 00 04		 sta pmBase+$300+.r*$100,y
   126 00,2628 99 00 05		 sta pmBase+$300+.r*$100,y
   126 00,262B 99 00 06		 sta pmBase+$300+.r*$100,y
   126 00,262E 99 00 07		 sta pmBase+$300+.r*$100,y
Source: D:\!Atari\getris2\grat\grat.asm
   128 00,2631 C8		 iny
   129 00,2632 D0 EE		 bne clr
   130
   131  [0000] 00 02 03 04	 .put = 0,2,3,4
   132 = 00,0024		 ?ofs = 36
   133 = 00,007E		 ?tmp = 126
   134
   135 				; copy pmg
   136 00,2634 A0 00		 ldy #0
   137 00,2636			copy
   138 				.rept 4
   139 				 lda pmg+.r*?tmp,y
   140 				 sta pmBase+$300+?ofs+.get[.r]*$100,y
   141 				.endr
Source: REPT
   139 00,2636 B9 09 24		 lda pmg+.r*?tmp,y
   140 00,2639 99 24 03		 sta pmBase+$300+?ofs+.get[.r]*$100,y
   139 00,263C B9 87 24		 lda pmg+.r*?tmp,y
   140 00,263F 99 24 05		 sta pmBase+$300+?ofs+.get[.r]*$100,y
   139 00,2642 B9 05 25		 lda pmg+.r*?tmp,y
   140 00,2645 99 24 06		 sta pmBase+$300+?ofs+.get[.r]*$100,y
   139 00,2648 B9 83 25		 lda pmg+.r*?tmp,y
   140 00,264B 99 24 07		 sta pmBase+$300+?ofs+.get[.r]*$100,y
Source: D:\!Atari\getris2\grat\grat.asm
   142 00,264E C8		 iny
   143 00,264F C0 7E		 cpy #?tmp
   144 00,2651 D0 E3		 bne copy
   145
   146 				 mwa #nmi $fffa
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2653 A9 00		  lda <NMI
     3 00,2655 8D FA FF		  sta $FFFA
     4 00,2658 A9 2E		  lda >NMI
     5 00,265A 8D FB FF		  sta $FFFA+1
Source: D:\!Atari\getris2\grat\grat.asm
   147
   148 				 mva #$c0 $d40e
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,265D A9 C0		 lda #$C0
     2 00,265F 8D 0E D4		 sta $D40E
Source: D:\!Atari\getris2\grat\grat.asm
   149
   150 				 mva #scr40 $d400	;set new screen's width
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2662 A9 3E		 lda #SCR40
     2 00,2664 8D 00 D4		 sta $D400
Source: D:\!Atari\getris2\grat\grat.asm
   151
   152 				;---
   153
   154 00,2667 20 43 31		 jsr fade_in
   155
   156 00,266A 20 8B 41		 jsr cmc.init
   157
   158 00,266D 20 B7 2E		 jsr stars
   159
   160 00,2670 20 BF 31		 jsr fade_out
   161
   162 				; jsr default_nmi
   163 00,2673 60		 rts
   164
   165 				;---
   166
   167 = 00,2674		 ?old_dli = *
   168
   169
   170 00,2674			dli
   171 				; line=32
   172 00,2674 A9 00		 lda #$00
   173 00,2676 A2 00		 ldx #$00
   174 00,2678 A0 00		 ldy #$00
   175 00,267A 8D 0A D4		 sta $d40a
   176 00,267D 8D 1E D0		 sta $d01e
   177 00,2680 8E 1E D0		 stx $d01e
   178 00,2683 8C 1E D0		 sty $d01e
   179 00,2686 EE 00 01		 inc byt3
   180
   181 				; line=33
   182
   183 00,2689 20 EF 2D		 jsr wait60cycle
   184
   185 				; line=34
   186
   187 00,268C 20 EF 2D		 jsr wait60cycle
   188
   189 				; line=35
   190
   191 00,268F 20 EF 2D		 jsr wait60cycle
   192
   193 				; line=36
   194
   195 00,2692 20 EF 2D		 jsr wait60cycle
   196
   197 				; line=37
   198
   199 00,2695 20 EF 2D		 jsr wait60cycle
   200
   201 				; line=38
   202
   203 00,2698 A9 7D		 lda #$7D
   204 00,269A A2 00		 ldx #$00
   205 00,269C A0 00		 ldy #$00
   206 00,269E 8D 03 D0		 sta hposp3
   207 00,26A1 8E 1E D0		 stx $d01e
   208 00,26A4 8C 1E D0		 sty $d01e
   209 00,26A7 A9 00		 lda #$00
   210 00,26A9 8D 1E D0		 sta $d01e
   211 00,26AC 20 F9 2D		 jsr wait36cycle
   212
   213 				; line=39
   214
   215 00,26AF 20 EF 2D		 jsr wait60cycle
   216
   217 				; line=40
   218
   219 00,26B2 A9 73		h0 lda #$73
   220 00,26B4 8D 00 D0		 sta hposp0
   221
   222 				 DLINEW dli48
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,26B7 A9 BF		 lda <DLI48
     2 00,26B9 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,26BC 4C B0 2E		 jmp NmiQuit
     9 = 00,26BF		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
   223
   224
   225
   226 00,26BF			dli48
   227 				; line=48
   228 00,26BF A9 14		 lda >fnt+$400*$01
   229 00,26C1 A2 74		h1 ldx #$74
   230 00,26C3 8D 0A D4		 sta $d40a
   231 00,26C6 8D 09 D4		 sta chbase
   232 00,26C9 8E 00 D0		 stx hposp0
   233
   234 				 DLINEW dli56
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,26CC A9 D4		 lda <DLI56
     2 00,26CE 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,26D1 4C B0 2E		 jmp NmiQuit
     9 = 00,26D4		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
   235
   236
   237
   238 00,26D4			dli56
   239 				; line=56
   240 00,26D4 A9 73		h2 lda #$73
   241 00,26D6 A2 00		 ldx #$00
   242 00,26D8 A0 00		 ldy #$00
   243 00,26DA 8D 0A D4		 sta $d40a
   244 00,26DD 8D 00 D0		 sta hposp0
   245 00,26E0 8E 1E D0		 stx $d01e
   246 00,26E3 8C 1E D0		 sty $d01e
   247 00,26E6 A9 00		 lda #$00
   248 00,26E8 8D 1E D0		 sta $d01e
   249 				; cmp byt2
   250
   251 				; line=57
   252
   253 00,26EB 20 EF 2D		 jsr wait60cycle
   254
   255 				; line=58
   256
   257 00,26EE A9 87		 lda #$87
   258 00,26F0 8D 06 D0		 sta hposm2
   259
   260 				 DLINEW dli64
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,26F3 A9 FB		 lda <DLI64
     2 00,26F5 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,26F8 4C B0 2E		 jmp NmiQuit
     9 = 00,26FB		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
   261
   262
   263
   264 00,26FB			dli64
   265 				; line=64
   266 00,26FB A9 74		h3 lda #$74
   267 00,26FD A2 00		 ldx #$00
   268 00,26FF A0 00		 ldy #$00
   269 00,2701 8D 0A D4		 sta $d40a
   270 00,2704 8D 00 D0		 sta hposp0
   271 00,2707 8E 1E D0		 stx $d01e
   272 00,270A 8C 1E D0		 sty $d01e
   273 00,270D A9 00		 lda #$00
   274 00,270F 8D 1E D0		 sta $d01e
   275 				; cmp byt2
   276
   277 				; line=65
   278
   279 00,2712 20 EF 2D		 jsr wait60cycle
   280
   281 				; line=66
   282
   283 00,2715 20 EF 2D		 jsr wait60cycle
   284
   285 				; line=67
   286
   287 00,2718 20 EF 2D		 jsr wait60cycle
   288
   289 				; line=68
   290
   291 00,271B 20 EF 2D		 jsr wait60cycle
   292
   293 				; line=69
   294
   295 00,271E 20 EF 2D		 jsr wait60cycle
   296
   297 				; line=70
   298
   299 00,2721 A9 7F		 lda #$7F
   300 00,2723 8D 03 D0		 sta hposp3
   301
   302 				 DLINEW dli72
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2726 A9 33		  lda <DLI72
     3 00,2728 8D 0C 2E		  sta DLIV+1
     4 00,272B A9 27		  lda >DLI72
     5 00,272D 8D 0D 2E		  sta DLIV+1+1
     7 00,2730 4C B0 2E		 jmp NmiQuit
     9 = 00,2733		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
   303
   304
   305
   306
   307 00,2733			dli72
   308 				; line=72
   309
   310 00,2733 A9 18		 lda >fnt+$400*$02
   311 00,2735 A2 70		h4 ldx #$70
   312 00,2737 A0 78		 ldy #$78
   313 00,2739 8D 0A D4		 sta $d40a
   314 00,273C 8D 09 D4		 sta chbase
   315 00,273F 8E 00 D0		 stx hposp0
   316 00,2742 8C 02 D0		 sty hposp2
   317 00,2745 A9 7A		 lda #$7A
   318 00,2747 8D 07 D0		 sta hposm3
   319 				; cmp byt2
   320
   321 				; line=73
   322
   323 00,274A A9 14		c9 lda #$14
   324 00,274C A2 03		 ldx #$03
   325 00,274E A0 30		 ldy #$30
   326 00,2750 8D 17 D0		 sta color1
   327 00,2753 8E 0B D0		 stx sizep3
   328 00,2756 8C 03 D0		 sty hposp3
   329 00,2759 A9 68		c10 lda #$68
   330 00,275B 8D 15 D0		 sta colpm3
   331 00,275E A2 68		c50 ldx #$68
   332 00,2760 8E 16 D0		 stx $D016
   333 00,2763 A0 18		c51 ldy #$18
   334 00,2765 8D 1E D0		 sta $D01E
   335 00,2768 A9 00		 lda #$00
   336 00,276A 8C 16 D0		 sty $D016
   337 00,276D A9 00		 lda #$00
   338 00,276F 8D 1E D0		 sta $D01E
   339 00,2772 8E 16 D0		 stx $D016
   340 00,2775 EA		 nop
   341 00,2776 A9 00		 lda #$00
   342 00,2778 8D 1E D0		 sta $D01E
   343
   344 				; line=74
   345
   346 00,277B A9 18		c11 lda #$18
   347 00,277D A2 00		 ldx #$00
   348 00,277F A0 00		 ldy #$00
   349 00,2781 8D 16 D0		 sta color0
   350 00,2784 8E 1E D0		 stx $d01e
   351 00,2787 8C 1E D0		 sty $d01e
   352 00,278A A9 00		 lda #$00
   353 00,278C 8D 1E D0		 sta $d01e
   354 00,278F A2 68		c52 ldx #$68
   355 00,2791 8E 16 D0		 stx $D016
   356 00,2794 A0 18		c53 ldy #$18
   357 00,2796 8D 1E D0		 sta $D01E
   358 00,2799 A9 00		 lda #$00
   359 00,279B 8C 16 D0		 sty $D016
   360 00,279E A9 00		 lda #$00
   361 00,27A0 8D 1E D0		 sta $D01E
   362 00,27A3 8E 16 D0		 stx $D016
   363 00,27A6 EA		 nop
   364 00,27A7 A9 00		 lda #$00
   365 00,27A9 8D 1E D0		 sta $D01E
   366
   367 				; line=75
   368
   369 00,27AC A9 18		c12 lda #$18
   370 00,27AE A2 C0		 ldx #$C0
   371 00,27B0 A0 AE		 ldy #$AE
   372 00,27B2 8D 16 D0		 sta color0
   373 00,27B5 8E 0C D0		 stx sizem
   374 00,27B8 8C 07 D0		 sty hposm3
   375 00,27BB A9 00		 lda #$00
   376 00,27BD 8D 1E D0		 sta $d01e
   377 00,27C0 A2 68		c54 ldx #$68
   378 00,27C2 8E 16 D0		 stx $D016
   379 00,27C5 A0 18		c55 ldy #$18
   380 00,27C7 8D 1E D0		 sta $D01E
   381 00,27CA A9 00		 lda #$00
   382 00,27CC 8C 16 D0		 sty $D016
   383 00,27CF A9 00		 lda #$00
   384 00,27D1 8D 1E D0		 sta $D01E
   385 00,27D4 8E 16 D0		 stx $D016
   386 00,27D7 EA		 nop
   387 00,27D8 A9 00		 lda #$00
   388 00,27DA 8D 1E D0		 sta $D01E
   389
   390 				; line=76
   391
   392 00,27DD A9 18		c13 lda #$18
   393 00,27DF A2 04		 ldx #$04
   394 00,27E1 A0 75		 ldy #$75
   395 00,27E3 8D 16 D0		 sta color0
   396 00,27E6 8E 1B D0		 stx gtictl
   397 00,27E9 8C 01 D0		 sty hposp1
   398 00,27EC A9 00		 lda #$00
   399 00,27EE 8D 1E D0		 sta $d01e
   400 00,27F1 A2 68		c56 ldx #$68
   401 00,27F3 8E 16 D0		 stx $D016
   402 00,27F6 A0 18		c57 ldy #$18
   403 00,27F8 8D 1E D0		 sta $D01E
   404 00,27FB A9 00		 lda #$00
   405 00,27FD 8C 16 D0		 sty $D016
   406 00,2800 A9 00		 lda #$00
   407 00,2802 8D 1E D0		 sta $D01E
   408 00,2805 8E 16 D0		 stx $D016
   409 00,2808 EA		 nop
   410 00,2809 A9 00		 lda #$00
   411 00,280B 8D 1E D0		 sta $D01E
   412
   413 				; line=77
   414
   415 00,280E A9 18		c14 lda #$18
   416 00,2810 A2 1A		c15 ldx #$1A
   417 00,2812 A0 00		 ldy #$00
   418 00,2814 8D 16 D0		 sta color0
   419 00,2817 8E 18 D0		 stx color2
   420 00,281A 8C 1E D0		 sty $d01e
   421 00,281D A9 00		 lda #$00
   422 00,281F 8D 1E D0		 sta $d01e
   423 00,2822 A2 68		c58 ldx #$68
   424 00,2824 8E 16 D0		 stx $D016
   425 00,2827 A0 18		c59 ldy #$18
   426 00,2829 8D 1E D0		 sta $D01E
   427 00,282C A9 00		 lda #$00
   428 00,282E 8C 16 D0		 sty $D016
   429 00,2831 A9 00		 lda #$00
   430 00,2833 8D 1E D0		 sta $D01E
   431 00,2836 8E 16 D0		 stx $D016
   432 00,2839 EA		 nop
   433 00,283A A9 00		 lda #$00
   434 00,283C 8D 1E D0		 sta $D01E
   435
   436 				; line=78
   437
   438 00,283F A9 18		c16 lda #$18
   439 00,2841 A2 02		 ldx #$02
   440 00,2843 A0 00		 ldy #$00
   441 00,2845 8D 16 D0		 sta color0
   442 00,2848 8E 1B D0		 stx gtictl
   443 00,284B 8C 1E D0		 sty $d01e
   444 00,284E A9 00		 lda #$00
   445 00,2850 8D 1E D0		 sta $d01e
   446 00,2853 A2 68		c60 ldx #$68
   447 00,2855 8E 16 D0		 stx $D016
   448 00,2858 A0 18		c61 ldy #$18
   449 00,285A 8D 1E D0		 sta $D01E
   450 00,285D A9 00		 lda #$00
   451 00,285F 8C 16 D0		 sty $D016
   452 00,2862 A9 00		 lda #$00
   453 00,2864 8D 1E D0		 sta $D01E
   454 00,2867 8E 16 D0		 stx $D016
   455 00,286A EA		 nop
   456 00,286B A9 00		 lda #$00
   457 00,286D 8D 1E D0		 sta $D01E
   458
   459 				; line=79
   460
   461 00,2870 A9 18		c17 lda #$18
   462 00,2872 A2 03		 ldx #$03
   463 00,2874 A0 B0		 ldy #$B0
   464 00,2876 8D 16 D0		 sta color0
   465 00,2879 8E 0A D0		 stx sizep2
   466 00,287C 8C 02 D0		 sty hposp2
   467 00,287F A9 68		c18 lda #$68
   468 00,2881 8D 14 D0		 sta colpm2
   469 00,2884 A2 68		c62 ldx #$68
   470 00,2886 8E 16 D0		 stx $D016
   471 00,2889 A0 18		c63 ldy #$18
   472 00,288B 8D 1E D0		 sta $D01E
   473 00,288E A9 00		 lda #$00
   474 00,2890 8C 16 D0		 sty $D016
   475 00,2893 A9 00		 lda #$00
   476 00,2895 8D 1E D0		 sta $D01E
   477 00,2898 8E 16 D0		 stx $D016
   478 00,289B EA		 nop
   479 00,289C A9 00		 lda #$00
   480 00,289E 8D 1E D0		 sta $D01E
   481
   482 				; line=80
   483
   484 00,28A1 A9 18		c19 lda #$18
   485 00,28A3 A2 6C		h5 ldx #$6C
   486 00,28A5 A0 00		 ldy #$00
   487 00,28A7 8D 16 D0		 sta color0
   488 00,28AA 8E 00 D0		 stx hposp0
   489 00,28AD 8C 1E D0		 sty $d01e
   490 00,28B0 A9 00		 lda #$00
   491 00,28B2 8D 1E D0		 sta $d01e
   492 00,28B5 C5 00		 cmp byt2
   493
   494 				; line=81
   495
   496 00,28B7 A9 18		c20 lda #$18
   497 00,28B9 A2 89		 ldx #$89
   498 00,28BB A0 00		 ldy #$00
   499 00,28BD 8D 16 D0		 sta color0
   500 00,28C0 8E 05 D0		 stx hposm1
   501 00,28C3 8C 1E D0		 sty $d01e
   502 00,28C6 A9 00		 lda #$00
   503 00,28C8 8D 1E D0		 sta $d01e
   504 00,28CB A2 68		c64 ldx #$68
   505 00,28CD 8E 16 D0		 stx $D016
   506 00,28D0 A0 18		c65 ldy #$18
   507 00,28D2 8D 1E D0		 sta $D01E
   508 00,28D5 A9 00		 lda #$00
   509 00,28D7 8C 16 D0		 sty $D016
   510 00,28DA A9 00		 lda #$00
   511 00,28DC 8D 1E D0		 sta $D01E
   512 00,28DF 8E 16 D0		 stx $D016
   513 00,28E2 EA		 nop
   514 00,28E3 A9 00		 lda #$00
   515 00,28E5 8D 1E D0		 sta $D01E
   516
   517 				; line=82
   518
   519 00,28E8 A9 18		c21 lda #$18
   520 00,28EA A2 80		 ldx #$80
   521 00,28EC A0 00		 ldy #$00
   522 00,28EE 8D 16 D0		 sta color0
   523 00,28F1 8E 05 D0		 stx hposm1
   524 00,28F4 8C 1E D0		 sty $d01e
   525 00,28F7 A9 00		 lda #$00
   526 00,28F9 8D 1E D0		 sta $d01e
   527 00,28FC A2 68		c66 ldx #$68
   528 00,28FE 8E 16 D0		 stx $D016
   529 00,2901 A0 18		c67 ldy #$18
   530 00,2903 8D 1E D0		 sta $D01E
   531 00,2906 A9 00		 lda #$00
   532 00,2908 8C 16 D0		 sty $D016
   533 00,290B A9 00		 lda #$00
   534 00,290D 8D 1E D0		 sta $D01E
   535 00,2910 8E 16 D0		 stx $D016
   536 00,2913 EA		 nop
   537 00,2914 A9 00		 lda #$00
   538 00,2916 8D 1E D0		 sta $D01E
   539
   540 				; line=83
   541
   542 00,2919 A9 18		c22 lda #$18
   543 00,291B A2 8A		 ldx #$8A
   544 00,291D A0 00		 ldy #$00
   545 00,291F 8D 16 D0		 sta color0
   546 00,2922 8E 05 D0		 stx hposm1
   547 00,2925 8C 1E D0		 sty $d01e
   548 00,2928 A9 00		 lda #$00
   549 00,292A 8D 1E D0		 sta $d01e
   550 00,292D A2 68		c68 ldx #$68
   551 00,292F 8E 16 D0		 stx $D016
   552 00,2932 A0 18		c69 ldy #$18
   553 00,2934 8D 1E D0		 sta $D01E
   554 00,2937 A9 00		 lda #$00
   555 00,2939 8C 16 D0		 sty $D016
   556 00,293C A9 00		 lda #$00
   557 00,293E 8D 1E D0		 sta $D01E
   558 00,2941 8E 16 D0		 stx $D016
   559 00,2944 EA		 nop
   560 00,2945 A9 00		 lda #$00
   561 00,2947 8D 1E D0		 sta $D01E
   562
   563 				; line=84
   564
   565 00,294A A9 18		c23 lda #$18
   566 00,294C A2 AC		 ldx #$AC
   567 00,294E A0 00		 ldy #$00
   568 00,2950 8D 16 D0		 sta color0
   569 00,2953 8E 07 D0		 stx hposm3
   570 00,2956 8C 1E D0		 sty $d01e
   571 00,2959 A9 00		 lda #$00
   572 00,295B 8D 1E D0		 sta $d01e
   573 00,295E A2 68		c70 ldx #$68
   574 00,2960 8E 16 D0		 stx $D016
   575 00,2963 A0 18		c71 ldy #$18
   576 00,2965 8D 1E D0		 sta $D01E
   577 00,2968 A9 00		 lda #$00
   578 00,296A 8C 16 D0		 sty $D016
   579 00,296D A9 00		 lda #$00
   580 00,296F 8D 1E D0		 sta $D01E
   581 00,2972 8E 16 D0		 stx $D016
   582 00,2975 EA		 nop
   583 00,2976 A9 00		 lda #$00
   584 00,2978 8D 1E D0		 sta $D01E
   585
   586 				; line=85
   587
   588 00,297B A9 18		c24 lda #$18
   589 00,297D A2 00		 ldx #$00
   590 00,297F A0 00		 ldy #$00
   591 00,2981 8D 16 D0		 sta color0
   592 00,2984 8E 1E D0		 stx $d01e
   593 00,2987 8C 1E D0		 sty $d01e
   594 00,298A A9 00		 lda #$00
   595 00,298C 8D 1E D0		 sta $d01e
   596 00,298F A2 68		c72 ldx #$68
   597 00,2991 8E 16 D0		 stx $D016
   598 00,2994 A0 18		c73 ldy #$18
   599 00,2996 8D 1E D0		 sta $D01E
   600 00,2999 A9 00		 lda #$00
   601 00,299B 8C 16 D0		 sty $D016
   602 00,299E A9 00		 lda #$00
   603 00,29A0 8D 1E D0		 sta $D01E
   604 00,29A3 8E 16 D0		 stx $D016
   605 00,29A6 EA		 nop
   606 00,29A7 A9 00		 lda #$00
   607 00,29A9 8D 1E D0		 sta $D01E
   608
   609 				; line=86
   610
   611 00,29AC A9 18		c25 lda #$18
   612 00,29AE A2 00		 ldx #$00
   613 00,29B0 A0 00		 ldy #$00
   614 00,29B2 8D 16 D0		 sta color0
   615 00,29B5 8E 1E D0		 stx $d01e
   616 00,29B8 8C 1E D0		 sty $d01e
   617 00,29BB A9 00		 lda #$00
   618 00,29BD 8D 1E D0		 sta $d01e
   619 00,29C0 A2 68		c74 ldx #$68
   620 00,29C2 8E 16 D0		 stx $D016
   621 00,29C5 A0 18		c75 ldy #$18
   622 00,29C7 8D 1E D0		 sta $D01E
   623 00,29CA A9 00		 lda #$00
   624 00,29CC 8C 16 D0		 sty $D016
   625 00,29CF A9 00		 lda #$00
   626 00,29D1 8D 1E D0		 sta $D01E
   627 00,29D4 8E 16 D0		 stx $D016
   628 00,29D7 EA		 nop
   629 00,29D8 A9 00		 lda #$00
   630 00,29DA 8D 1E D0		 sta $D01E
   631
   632 				; line=87
   633
   634 00,29DD A9 18		c26 lda #$18
   635 00,29DF A2 01		 ldx #$01
   636 00,29E1 A0 80		 ldy #$80
   637 00,29E3 8D 16 D0		 sta color0
   638 00,29E6 8E 09 D0		 stx sizep1
   639 00,29E9 8C 05 D0		 sty hposm1
   640 00,29EC A9 00		 lda #$00
   641 00,29EE 8D 1E D0		 sta $d01e
   642 00,29F1 A2 68		c76 ldx #$68
   643 00,29F3 8E 16 D0		 stx $D016
   644 00,29F6 A0 18		c77 ldy #$18
   645 00,29F8 8D 1E D0		 sta $D01E
   646 00,29FB A9 00		 lda #$00
   647 00,29FD 8C 16 D0		 sty $D016
   648 00,2A00 A9 00		 lda #$00
   649 00,2A02 8D 1E D0		 sta $D01E
   650 00,2A05 8E 16 D0		 stx $D016
   651 00,2A08 EA		 nop
   652 00,2A09 A9 00		 lda #$00
   653 00,2A0B 8D 1E D0		 sta $D01E
   654
   655 				; line=88
   656
   657 00,2A0E A9 18		c27 lda #$18
   658 00,2A10 A2 00		 ldx #$00
   659 00,2A12 A0 6D		h6 ldy #$6D
   660 00,2A14 8D 16 D0		 sta color0
   661 00,2A17 8E 09 D0		 stx sizep1
   662 00,2A1A 8C 00 D0		 sty hposp0
   663 00,2A1D A9 8A		 lda #$8A
   664 00,2A1F 8D 05 D0		 sta hposm1
   665 00,2A22 C5 00		 cmp byt2
   666
   667 				; line=89
   668
   669 00,2A24 A9 18		c28 lda #$18
   670 00,2A26 A2 80		 ldx #$80
   671 00,2A28 A0 00		 ldy #$00
   672 00,2A2A 8D 16 D0		 sta color0
   673 00,2A2D 8E 05 D0		 stx hposm1
   674 00,2A30 8C 1E D0		 sty $d01e
   675 00,2A33 A9 00		 lda #$00
   676 00,2A35 8D 1E D0		 sta $d01e
   677 00,2A38 A2 68		c78 ldx #$68
   678 00,2A3A 8E 16 D0		 stx $D016
   679 00,2A3D A0 18		c79 ldy #$18
   680 00,2A3F 8D 1E D0		 sta $D01E
   681 00,2A42 A9 00		 lda #$00
   682 00,2A44 8C 16 D0		 sty $D016
   683 00,2A47 A9 00		 lda #$00
   684 00,2A49 8D 1E D0		 sta $D01E
   685 00,2A4C 8E 16 D0		 stx $D016
   686 00,2A4F EA		 nop
   687 00,2A50 A9 00		 lda #$00
   688 00,2A52 8D 1E D0		 sta $D01E
   689
   690 				; line=90
   691
   692 00,2A55 A9 18		c29 lda #$18
   693 00,2A57 A2 77		 ldx #$77
   694 00,2A59 A0 89		 ldy #$89
   695 00,2A5B 8D 16 D0		 sta color0
   696 00,2A5E 8E 01 D0		 stx hposp1
   697 00,2A61 8C 05 D0		 sty hposm1
   698 00,2A64 A9 00		 lda #$00
   699 00,2A66 8D 1E D0		 sta $d01e
   700 00,2A69 A2 68		c80 ldx #$68
   701 00,2A6B 8E 16 D0		 stx $D016
   702 00,2A6E A0 18		c81 ldy #$18
   703 00,2A70 8D 1E D0		 sta $D01E
   704 00,2A73 A9 00		 lda #$00
   705 00,2A75 8C 16 D0		 sty $D016
   706 00,2A78 A9 00		 lda #$00
   707 00,2A7A 8D 1E D0		 sta $D01E
   708 00,2A7D 8E 16 D0		 stx $D016
   709 00,2A80 EA		 nop
   710 00,2A81 A9 00		 lda #$00
   711 00,2A83 8D 1E D0		 sta $D01E
   712
   713 				; line=91
   714
   715 00,2A86 A9 18		c30 lda #$18
   716 00,2A88 A2 00		 ldx #$00
   717 00,2A8A A0 00		 ldy #$00
   718 00,2A8C 8D 16 D0		 sta color0
   719 00,2A8F 8E 1E D0		 stx $d01e
   720 00,2A92 8C 1E D0		 sty $d01e
   721 00,2A95 A9 00		 lda #$00
   722 00,2A97 8D 1E D0		 sta $d01e
   723 00,2A9A A2 68		c82 ldx #$68
   724 00,2A9C 8E 16 D0		 stx $D016
   725 00,2A9F A0 18		c83 ldy #$18
   726 00,2AA1 8D 1E D0		 sta $D01E
   727 00,2AA4 A9 00		 lda #$00
   728 00,2AA6 8C 16 D0		 sty $D016
   729 00,2AA9 A9 00		 lda #$00
   730 00,2AAB 8D 1E D0		 sta $D01E
   731 00,2AAE 8E 16 D0		 stx $D016
   732 00,2AB1 EA		 nop
   733 00,2AB2 A9 00		 lda #$00
   734 00,2AB4 8D 1E D0		 sta $D01E
   735
   736 				; line=92
   737
   738 00,2AB7 A9 18		c31 lda #$18
   739 00,2AB9 A2 80		 ldx #$80
   740 00,2ABB A0 00		 ldy #$00
   741 00,2ABD 8D 16 D0		 sta color0
   742 00,2AC0 8E 05 D0		 stx hposm1
   743 00,2AC3 8C 1E D0		 sty $d01e
   744 00,2AC6 A9 00		 lda #$00
   745 00,2AC8 8D 1E D0		 sta $d01e
   746 00,2ACB A2 68		c84 ldx #$68
   747 00,2ACD 8E 16 D0		 stx $D016
   748 00,2AD0 A0 18		c85 ldy #$18
   749 00,2AD2 8D 1E D0		 sta $D01E
   750 00,2AD5 A9 00		 lda #$00
   751 00,2AD7 8C 16 D0		 sty $D016
   752 00,2ADA A9 00		 lda #$00
   753 00,2ADC 8D 1E D0		 sta $D01E
   754 00,2ADF 8E 16 D0		 stx $D016
   755 00,2AE2 EA		 nop
   756 00,2AE3 A9 00		 lda #$00
   757 00,2AE5 8D 1E D0		 sta $D01E
   758
   759 				; line=93
   760
   761 00,2AE8 A9 18		c32 lda #$18
   762 00,2AEA A2 78		 ldx #$78
   763 00,2AEC A0 87		 ldy #$87
   764 00,2AEE 8D 16 D0		 sta color0
   765 00,2AF1 8E 01 D0		 stx hposp1
   766 00,2AF4 8C 05 D0		 sty hposm1
   767 00,2AF7 A9 00		 lda #$00
   768 00,2AF9 8D 1E D0		 sta $d01e
   769 00,2AFC A0 18		c86 ldy #$18
   770 00,2AFE 8C 16 D0		 sty $D016
   771 00,2B01 EA EA		 :2 nop
   772 00,2B03 A2 68		c87 ldx #$68
   773 00,2B05 A9 00		 lda #$00
   774 00,2B07 8D 1E D0		 sta $D01E
   775 00,2B0A A9 00		 lda #$00
   776 00,2B0C 8D 1E D0		 sta $D01E
   777 00,2B0F 8E 16 D0		 stx $D016
   778 00,2B12 EA		 nop
   779 00,2B13 A9 00		 lda #$00
   780 00,2B15 8D 1E D0		 sta $D01E
   781
   782 				; line=94
   783
   784 00,2B18 A9 80		 lda #$80
   785 00,2B1A A2 00		 ldx #$00
   786 00,2B1C A0 00		 ldy #$00
   787 00,2B1E 8D 05 D0		 sta hposm1
   788 00,2B21 8E 1E D0		 stx $d01e
   789 00,2B24 8C 1E D0		 sty $d01e
   790 00,2B27 A9 00		 lda #$00
   791 00,2B29 8D 1E D0		 sta $d01e
   792 00,2B2C A0 18		c88 ldy #$18
   793 00,2B2E 8C 16 D0		 sty $D016
   794 00,2B31 EA EA		 :2 nop
   795 00,2B33 A2 68		c89 ldx #$68
   796 00,2B35 A9 00		 lda #$00
   797 00,2B37 8D 1E D0		 sta $D01E
   798 00,2B3A A9 00		 lda #$00
   799 00,2B3C 8D 1E D0		 sta $D01E
   800 00,2B3F 8E 16 D0		 stx $D016
   801 00,2B42 EA		 nop
   802 00,2B43 A9 00		 lda #$00
   803 00,2B45 8D 1E D0		 sta $D01E
   804
   805 				; line=95
   806
   807 00,2B48 A9 87		 lda #$87
   808 00,2B4A A2 00		 ldx #$00
   809 00,2B4C A0 00		 ldy #$00
   810 00,2B4E 8D 05 D0		 sta hposm1
   811 00,2B51 8E 1E D0		 stx $d01e
   812 00,2B54 8C 1E D0		 sty $d01e
   813 00,2B57 A9 00		 lda #$00
   814 00,2B59 8D 1E D0		 sta $d01e
   815 00,2B5C A0 18		c90 ldy #$18
   816 00,2B5E 8C 16 D0		 sty $D016
   817 00,2B61 EA EA		 :2 nop
   818 00,2B63 A2 68		c91 ldx #$68
   819 00,2B65 A9 00		 lda #$00
   820 00,2B67 8D 1E D0		 sta $D01E
   821 00,2B6A A9 00		 lda #$00
   822 00,2B6C 8D 1E D0		 sta $D01E
   823 00,2B6F 8E 16 D0		 stx $D016
   824 00,2B72 EA		 nop
   825 00,2B73 A9 00		 lda #$00
   826 00,2B75 8D 1E D0		 sta $D01E
   827
   828 				; line=96
   829
   830 00,2B78 A9 1C		 lda >fnt+$400*$03
   831 00,2B7A A2 18		c33 ldx #$18
   832 00,2B7C A0 70		h7 ldy #$70
   833 00,2B7E 8D 09 D4		 sta chbase
   834 00,2B81 8E 16 D0		 stx color0
   835 00,2B84 8C 00 D0		 sty hposp0
   836 00,2B87 A9 00		 lda #$00
   837 00,2B89 8D 1E D0		 sta $d01e
   838 00,2B8C C5 00		 cmp byt2
   839
   840 				; line=97
   841
   842 00,2B8E A9 18		c34 lda #$18
   843 00,2B90 A2 80		 ldx #$80
   844 00,2B92 A0 00		 ldy #$00
   845 00,2B94 8D 16 D0		 sta color0
   846 00,2B97 8E 05 D0		 stx hposm1
   847 00,2B9A 8C 1E D0		 sty $d01e
   848 00,2B9D A9 00		 lda #$00
   849 00,2B9F 8D 1E D0		 sta $d01e
   850 00,2BA2 A0 18		c92 ldy #$18
   851 00,2BA4 8C 16 D0		 sty $D016
   852 00,2BA7 EA EA		 :2 nop
   853 00,2BA9 A2 68		c93 ldx #$68
   854 00,2BAB A9 00		 lda #$00
   855 00,2BAD 8D 1E D0		 sta $D01E
   856 00,2BB0 A9 00		 lda #$00
   857 00,2BB2 8D 1E D0		 sta $D01E
   858 00,2BB5 8E 16 D0		 stx $D016
   859 00,2BB8 EA		 nop
   860 00,2BB9 A9 00		 lda #$00
   861 00,2BBB 8D 1E D0		 sta $D01E
   862
   863 				; line=98
   864
   865 00,2BBE A9 18		c35 lda #$18
   866 00,2BC0 A2 7A		 ldx #$7A
   867 00,2BC2 A0 86		 ldy #$86
   868 00,2BC4 8D 16 D0		 sta color0
   869 00,2BC7 8E 01 D0		 stx hposp1
   870 00,2BCA 8C 05 D0		 sty hposm1
   871 00,2BCD A9 00		 lda #$00
   872 00,2BCF 8D 1E D0		 sta $d01e
   873 00,2BD2 A0 18		c94 ldy #$18
   874 00,2BD4 8C 16 D0		 sty $D016
   875 00,2BD7 EA EA		 :2 nop
   876 00,2BD9 A2 68		c95 ldx #$68
   877 00,2BDB A9 00		 lda #$00
   878 00,2BDD 8D 1E D0		 sta $D01E
   879 00,2BE0 A9 00		 lda #$00
   880 00,2BE2 8D 1E D0		 sta $D01E
   881 00,2BE5 8E 16 D0		 stx $D016
   882 00,2BE8 EA		 nop
   883 00,2BE9 A9 00		 lda #$00
   884 00,2BEB 8D 1E D0		 sta $D01E
   885
   886 				; line=99
   887
   888 00,2BEE A9 18		c36 lda #$18
   889 00,2BF0 A2 00		 ldx #$00
   890 00,2BF2 A0 00		 ldy #$00
   891 00,2BF4 8D 16 D0		 sta color0
   892 00,2BF7 8E 1E D0		 stx $d01e
   893 00,2BFA 8C 1E D0		 sty $d01e
   894 00,2BFD A9 00		 lda #$00
   895 00,2BFF 8D 1E D0		 sta $d01e
   896 00,2C02 A0 18		c96 ldy #$18
   897 00,2C04 8C 16 D0		 sty $D016
   898 00,2C07 EA EA		 :2 nop
   899 00,2C09 A2 68		c97 ldx #$68
   900 00,2C0B A9 00		 lda #$00
   901 00,2C0D 8D 1E D0		 sta $D01E
   902 00,2C10 A9 00		 lda #$00
   903 00,2C12 8D 1E D0		 sta $D01E
   904 00,2C15 8E 16 D0		 stx $D016
   905 00,2C18 EA		 nop
   906 00,2C19 A9 00		 lda #$00
   907 00,2C1B 8D 1E D0		 sta $D01E
   908
   909 				; line=100
   910
   911 00,2C1E A9 18		c37 lda #$18
   912 00,2C20 A2 85		 ldx #$85
   913 00,2C22 A0 00		 ldy #$00
   914 00,2C24 8D 16 D0		 sta color0
   915 00,2C27 8E 05 D0		 stx hposm1
   916 00,2C2A 8C 1E D0		 sty $d01e
   917 00,2C2D A9 00		 lda #$00
   918 00,2C2F 8D 1E D0		 sta $d01e
   919 00,2C32 A0 18		c98 ldy #$18
   920 00,2C34 8C 16 D0		 sty $D016
   921 00,2C37 EA EA		 :2 nop
   922 00,2C39 A2 68		c99 ldx #$68
   923 00,2C3B A9 00		 lda #$00
   924 00,2C3D 8D 1E D0		 sta $D01E
   925 00,2C40 A9 00		 lda #$00
   926 00,2C42 8D 1E D0		 sta $D01E
   927 00,2C45 8E 16 D0		 stx $D016
   928 00,2C48 EA		 nop
   929 00,2C49 A9 00		 lda #$00
   930 00,2C4B 8D 1E D0		 sta $D01E
   931
   932 				; line=101
   933
   934 00,2C4E A9 18		c38 lda #$18
   935 00,2C50 A2 80		 ldx #$80
   936 00,2C52 A0 00		 ldy #$00
   937 00,2C54 8D 16 D0		 sta color0
   938 00,2C57 8E 05 D0		 stx hposm1
   939 00,2C5A 8C 1E D0		 sty $d01e
   940 00,2C5D A9 00		 lda #$00
   941 00,2C5F 8D 1E D0		 sta $d01e
   942 00,2C62 A0 18		c100 ldy #$18
   943 00,2C64 8C 16 D0		 sty $D016
   944 00,2C67 EA EA		 :2 nop
   945 00,2C69 A2 68		c101 ldx #$68
   946 00,2C6B A9 00		 lda #$00
   947 00,2C6D 8D 1E D0		 sta $D01E
   948 00,2C70 A9 00		 lda #$00
   949 00,2C72 8D 1E D0		 sta $D01E
   950 00,2C75 8E 16 D0		 stx $D016
   951 00,2C78 EA		 nop
   952 00,2C79 A9 00		 lda #$00
   953 00,2C7B 8D 1E D0		 sta $D01E
   954
   955 				; line=102
   956
   957 00,2C7E A9 18		c39 lda #$18
   958 00,2C80 A2 00		 ldx #$00
   959 00,2C82 A0 00		 ldy #$00
   960 00,2C84 8D 16 D0		 sta color0
   961 00,2C87 8E 1E D0		 stx $d01e
   962 00,2C8A 8C 1E D0		 sty $d01e
   963 00,2C8D A9 00		 lda #$00
   964 00,2C8F 8D 1E D0		 sta $d01e
   965 00,2C92 A0 18		c102 ldy #$18
   966 00,2C94 8C 16 D0		 sty $D016
   967 00,2C97 EA EA		 :2 nop
   968 00,2C99 A2 68		c103 ldx #$68
   969 00,2C9B A9 00		 lda #$00
   970 00,2C9D 8D 1E D0		 sta $D01E
   971 00,2CA0 A9 00		 lda #$00
   972 00,2CA2 8D 1E D0		 sta $D01E
   973 00,2CA5 8E 16 D0		 stx $D016
   974 00,2CA8 EA		 nop
   975 00,2CA9 A9 00		 lda #$00
   976 00,2CAB 8D 1E D0		 sta $D01E
   977
   978 				; line=103
   979
   980 00,2CAE A9 18		c40 lda #$18
   981 00,2CB0 A2 7C		 ldx #$7C
   982 00,2CB2 A0 83		 ldy #$83
   983 00,2CB4 8D 16 D0		 sta color0
   984 00,2CB7 8E 01 D0		 stx hposp1
   985 00,2CBA 8C 05 D0		 sty hposm1
   986 00,2CBD A9 00		 lda #$00
   987 00,2CBF 8D 1E D0		 sta $d01e
   988 00,2CC2 A0 18		c104 ldy #$18
   989 00,2CC4 8C 16 D0		 sty $D016
   990 00,2CC7 EA EA		 :2 nop
   991 00,2CC9 A2 68		c105 ldx #$68
   992 00,2CCB A9 00		 lda #$00
   993 00,2CCD 8D 1E D0		 sta $D01E
   994 00,2CD0 A9 00		 lda #$00
   995 00,2CD2 8D 1E D0		 sta $D01E
   996 00,2CD5 8E 16 D0		 stx $D016
   997 00,2CD8 EA		 nop
   998 00,2CD9 A9 00		 lda #$00
   999 00,2CDB 8D 1E D0		 sta $D01E
  1000
  1001 				; line=104
  1002
  1003 00,2CDE A9 18		c41 lda #$18
  1004 00,2CE0 A2 74		h8 ldx #$74
  1005 00,2CE2 A0 00		 ldy #$00
  1006 00,2CE4 8D 16 D0		 sta color0
  1007 00,2CE7 8E 00 D0		 stx hposp0
  1008 00,2CEA 8C 1E D0		 sty $d01e
  1009 00,2CED A9 00		 lda #$00
  1010 00,2CEF 8D 1E D0		 sta $d01e
  1011 00,2CF2 C5 00		 cmp byt2
  1012
  1013 				; line=105
  1014
  1015 00,2CF4 A9 18		c42 lda #$18
  1016 00,2CF6 A2 00		 ldx #$00
  1017 00,2CF8 A0 00		 ldy #$00
  1018 00,2CFA 8D 16 D0		 sta color0
  1019 00,2CFD 8E 1E D0		 stx $d01e
  1020 00,2D00 8C 1E D0		 sty $d01e
  1021 00,2D03 A9 00		 lda #$00
  1022 00,2D05 8D 1E D0		 sta $d01e
  1023 00,2D08 20 F9 2D		 jsr wait36cycle
  1024
  1025 				; line=106
  1026
  1027 00,2D0B A9 18		c43 lda #$18
  1028 00,2D0D A2 7E		 ldx #$7E
  1029 00,2D0F A0 0C		c44 ldy #$0C
  1030 00,2D11 8D 16 D0		 sta color0
  1031 00,2D14 8E 01 D0		 stx hposp1
  1032 00,2D17 8C 15 D0		 sty colpm3
  1033 00,2D1A A9 00		 lda #$00
  1034 00,2D1C 8D 1E D0		 sta $d01e
  1035 00,2D1F 20 F9 2D		 jsr wait36cycle
  1036
  1037 				; line=107
  1038
  1039 00,2D22 A9 0C		c45 lda #$0C
  1040 00,2D24 8D 14 D0		 sta colpm2
  1041
  1042 				 DLINEW dli112
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2D27 A9 34		  lda <DLI112
     3 00,2D29 8D 0C 2E		  sta DLIV+1
     4 00,2D2C A9 2D		  lda >DLI112
     5 00,2D2E 8D 0D 2E		  sta DLIV+1+1
     7 00,2D31 4C B0 2E		 jmp NmiQuit
     9 = 00,2D34		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
  1043
  1044
  1045
  1046
  1047 00,2D34			dli112
  1048 				; line=112
  1049 00,2D34 A9 72		h9 lda #$72
  1050 00,2D36 A2 00		 ldx #$00
  1051 00,2D38 A0 00		 ldy #$00
  1052 00,2D3A 8D 0A D4		 sta $d40a
  1053 00,2D3D 8D 00 D0		 sta hposp0
  1054 00,2D40 8E 1E D0		 stx $d01e
  1055 00,2D43 8C 1E D0		 sty $d01e
  1056 00,2D46 A9 00		 lda #$00
  1057 00,2D48 8D 1E D0		 sta $d01e
  1058 				; cmp byt2
  1059
  1060 				; line=113
  1061
  1062 00,2D4B 20 EF 2D		 jsr wait60cycle
  1063
  1064 				; line=114
  1065
  1066 00,2D4E 20 EF 2D		 jsr wait60cycle
  1067
  1068 				; line=115
  1069
  1070 00,2D51 A9 7C		 lda #$7C
  1071 00,2D53 A2 00		 ldx #$00
  1072 00,2D55 A0 00		 ldy #$00
  1073 00,2D57 8D 01 D0		 sta hposp1
  1074 00,2D5A 8E 1E D0		 stx $d01e
  1075 00,2D5D 8C 1E D0		 sty $d01e
  1076 00,2D60 A9 00		 lda #$00
  1077 00,2D62 8D 1E D0		 sta $d01e
  1078 00,2D65 20 F9 2D		 jsr wait36cycle
  1079
  1080 				; line=116
  1081
  1082 00,2D68 20 EF 2D		 jsr wait60cycle
  1083
  1084 				; line=117
  1085
  1086 00,2D6B A9 7B		 lda #$7B
  1087 00,2D6D A2 00		 ldx #$00
  1088 00,2D6F A0 00		 ldy #$00
  1089 00,2D71 8D 01 D0		 sta hposp1
  1090 00,2D74 8E 1E D0		 stx $d01e
  1091 00,2D77 8C 1E D0		 sty $d01e
  1092 00,2D7A A9 00		 lda #$00
  1093 00,2D7C 8D 1E D0		 sta $d01e
  1094 00,2D7F 20 F9 2D		 jsr wait36cycle
  1095
  1096 				; line=118
  1097
  1098 00,2D82 20 EF 2D		 jsr wait60cycle
  1099
  1100 				; line=119
  1101
  1102 00,2D85 A9 7A		 lda #$7A
  1103 00,2D87 8D 01 D0		 sta hposp1
  1104
  1105 				 DLINEW dli120
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2D8A A9 92		 lda <DLI120
     2 00,2D8C 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,2D8F 4C B0 2E		 jmp NmiQuit
     9 = 00,2D92		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
  1106
  1107
  1108
  1109
  1110 00,2D92			dli120
  1111 				; line=120
  1112 00,2D92 A9 10		 lda >fnt+$400*$00
  1113 00,2D94 8D 0A D4		 sta $d40a
  1114 00,2D97 8D 09 D4		 sta chbase
  1115
  1116 				; line=124
  1117 00,2D9A A9 F0		 lda #$F0
  1118 00,2D9C A2 68		 ldx #$68
  1119 00,2D9E 8D 0C D0		 sta sizem
  1120 00,2DA1 8E 06 D0		 stx hposm2
  1121
  1122 				; line=125
  1123 00,2DA4 A9 01		 lda #$01
  1124 00,2DA6 A2 00		 ldx #$00
  1125 00,2DA8 A0 90		 ldy #$90
  1126 00,2DAA 8D 1B D0		 sta gtictl
  1127 00,2DAD 8E 0A D0		 stx sizep2
  1128 00,2DB0 8C 02 D0		 sty hposp2
  1129 00,2DB3 A9 0A		c46 lda #$0A
  1130 00,2DB5 8D 14 D0		 sta colpm2
  1131
  1132 				; line=127
  1133 00,2DB8 A9 00		c47 lda #$00
  1134 00,2DBA A2 08		c48 ldx #$08
  1135 00,2DBC 8D 17 D0		 sta color1
  1136 00,2DBF 8E 18 D0		 stx color2
  1137
  1138 				 DLINEW dli128
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2DC2 A9 CA		 lda <DLI128
     2 00,2DC4 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,2DC7 4C B0 2E		 jmp NmiQuit
     9 = 00,2DCA		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
  1139
  1140
  1141
  1142 00,2DCA			dli128
  1143 				; line=128
  1144 00,2DCA A9 1C		 lda >fnt+$400*$03
  1145 00,2DCC A2 03		 ldx #$03
  1146 00,2DCE A0 70		 ldy #$70
  1147 00,2DD0 8D 0A D4		 sta $d40a
  1148 00,2DD3 8D 09 D4		 sta chbase
  1149 00,2DD6 8E 09 D0		 stx sizep1
  1150 00,2DD9 8C 01 D0		 sty hposp1
  1151
  1152 				 DLINEW dli144
Macro: DLINEW [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2DDC A9 E4		 lda <DLI144
     2 00,2DDE 8D 0C 2E		 sta DLIV+1
Source: D:\!Atari\getris2\grat\grat.asm
     7 00,2DE1 4C B0 2E		 jmp NmiQuit
     9 = 00,2DE4		 ?old_dli = *
Source: D:\!Atari\getris2\grat\grat.asm
  1153
  1154
  1155
  1156 00,2DE4			dli144
  1157 				; line=144
  1158 00,2DE4 A9 20		 lda >fnt+$400*$04
  1159 00,2DE6 8D 0A D4		 sta $d40a
  1160 00,2DE9 8D 09 D4		 sta chbase
  1161
  1162 00,2DEC 4C B0 2E		 jmp nmiQuit
  1163
  1164
  1165 				;--
  1166
  1167 00,2DEF			wait60cycle
  1168 00,2DEF 20 FF 2D		 jsr _rts
  1169 00,2DF2 CD 00 01		 cmp byt3
  1170 00,2DF5			wait44cycle
  1171 00,2DF5 EE 00 01		 inc byt3
  1172 00,2DF8 EA		 nop
  1173 00,2DF9			wait36cycle
  1174 00,2DF9 20 FF 2D		 jsr _rts
  1175 00,2DFC			wait24cycle
  1176 00,2DFC 20 FF 2D		 jsr _rts
  1177 00,2DFF 60		_rts rts
  1178
  1179
  1180 00,2E00			nmi
  1181 00,2E00 85 82		 sta regA
  1182 00,2E02 86 83		 stx regX
  1183 00,2E04 84 84		 sty regY
  1184
  1185 00,2E06 2C 0F D4		 bit $d40f
  1186 00,2E09 10 03		 bpl vbl
  1187
  1188 00,2E0B 4C 74 26		dliv jmp dli
  1189
  1190 00,2E0E			vbl
  1191 00,2E0E 8D 0F D4		 sta $d40f
  1192
  1193 00,2E11 E6 14		 inc cloc
  1194
  1195 				 mwa #ant $d402
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2E13 A9 70		  lda <ANT
     3 00,2E15 8D 02 D4		  sta $D402
     4 00,2E18 A9 21		  lda >ANT
     5 00,2E1A 8D 03 D4		  sta $D402+1
Source: D:\!Atari\getris2\grat\grat.asm
  1196 				 mva #scr40 $d400
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2E1D A9 3E		 lda #SCR40
     2 00,2E1F 8D 00 D4		 sta $D400
Source: D:\!Atari\getris2\grat\grat.asm
  1197
  1198 00,2E22 A9 10		 lda >fnt+$400*$00
  1199 00,2E24 8D 09 D4		 sta chbase
  1200 00,2E27 A9 00		c0 lda #$00
  1201 00,2E29 8D 1A D0		 sta colbak
  1202 00,2E2C A9 18		c1 lda #$18
  1203 00,2E2E 8D 16 D0		 sta color0
  1204 00,2E31 A9 68		c2 lda #$68
  1205 00,2E33 8D 17 D0		 sta color1
  1206 00,2E36 A9 4A		c3 lda #$4A
  1207 00,2E38 8D 18 D0		 sta color2
  1208 00,2E3B A9 74		c4 lda #$74
  1209 00,2E3D 8D 19 D0		 sta color3
  1210 00,2E40 A9 02		 lda #$02
  1211 00,2E42 8D 1B D0		 sta gtictl
  1212 00,2E45 A9 00		 lda #$00
  1213 00,2E47 8D 09 D0		 sta sizep1
  1214 00,2E4A 8D 0A D0		 sta sizep2
  1215 00,2E4D 8D 0B D0		 sta sizep3
  1216 00,2E50 8D 0C D0		 sta sizem
  1217 00,2E53 8D 08 D0		 sta sizep0 
  1218 00,2E56 A9 7D		 lda #$7D
  1219 00,2E58 8D 01 D0		 sta hposp1
  1220 00,2E5B A9 7C		 lda #$7C
  1221 00,2E5D 8D 02 D0		 sta hposp2
  1222 				; lda #$7C
  1223 00,2E60 8D 03 D0		 sta hposp3
  1224 00,2E63 A9 7B		 lda #$7B
  1225 00,2E65 8D 05 D0		 sta hposm1
  1226 00,2E68 A9 84		 lda #$84
  1227 00,2E6A 8D 06 D0		 sta hposm2
  1228 00,2E6D A9 7B		 lda #$7B
  1229 00,2E6F 8D 07 D0		 sta hposm3
  1230 00,2E72 A9 0C		c5 lda #$0C
  1231 00,2E74 8D 13 D0		 sta colpm1
  1232 00,2E77 A9 1A		c6 lda #$1A
  1233 00,2E79 8D 14 D0		 sta colpm2
  1234 00,2E7C A9 14		c7 lda #$14
  1235 00,2E7E 8D 15 D0		 sta colpm3
  1236 00,2E81 A9 74		h0_ lda #$74
  1237 00,2E83 8D 00 D0		 sta hposp0
  1238 00,2E86 A9 FF		c8 lda #$ff
  1239 00,2E88 8D 12 D0		 sta colpm0
  1240
  1241 				 mwa #dli dliv+1
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2E8B A9 74		  lda <DLI
     3 00,2E8D 8D 0C 2E		  sta DLIV+1
     4 00,2E90 A9 26		  lda >DLI
     5 00,2E92 8D 0D 2E		  sta DLIV+1+1
Source: D:\!Atari\getris2\grat\grat.asm
  1242
  1243 00,2E95 20 A2 41		play_stop jsr cmc.PLAYERCMC+6
  1244
  1245 00,2E98 AD 10 D0		 lda $d010
  1246 00,2E9B D0 13		 bne nmiQuit
  1247
  1248 00,2E9D A9 60		 lda #{rts}
  1249 00,2E9F 8D CB 2E		 sta return
  1250
  1251 00,2EA2 A9 EA		 lda #{nop}
  1252 00,2EA4 8D 95 2E		 sta play_stop
  1253 00,2EA7 8D 96 2E		 sta play_stop+1
  1254 00,2EAA 8D 97 2E		 sta play_stop+2
  1255
  1256 00,2EAD 20 E3 48		 jsr reset_pokey
  1257
  1258 00,2EB0			nmiQuit
  1259 00,2EB0 A5 82		 lda regA
  1260 00,2EB2 A6 83		 ldx regX
  1261 00,2EB4 A4 84		 ldy regY
  1262 00,2EB6 40		 rti
  1263
  1264 00,2EB7			 icl 'stars_add.asm'
Source: D:\!Atari\getris2\grat\stars_add.asm
     1 				; !!! licznik COUNT musi zliczac od 0... a nie od tylu !!!
     2
     3 = 00,0000		pmg_stars	equ pmBase
     4
     5
     6 = 00,000B		sile    equ 11
     7
     8 = 00,0085		tmp	equ zp_free
     9
    10
    11 00,2EB7			stars
    12
    13 00,2EB7 20 CE 2E		 jsr stars_init
    14
    15 00,2EBA			loop
    16
    17 00,2EBA 20 F9 2E		 jsr stars_losuj
    18
    19 00,2EBD A2 06		 ldx #6
    20 				wai lda:cmp:req 20
    20 00,2EBF A5 14		 lda 20
    20 00,2EC1 C5 14		 cmp 20
    20 00,2EC3 F0 FC		 req$2EC1 20
    21 00,2EC5 CA		 dex
    22 00,2EC6 D0 F7		 bne wai
    23
    24 00,2EC8 20 85 2F		 jsr stars_animuj
    25
    26 00,2ECB 4C BA 2E		return jmp loop
    27
    28
    29 				;---
    30
    31
    32 00,2ECE			.proc STARS_INIT
    33
    34 				 mwa #tstars tmp
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2ECE A9 82		  lda <TSTARS
     3 00,2ED0 85 85		  sta TMP
     4 00,2ED2 A9 30		  lda >TSTARS
     5 00,2ED4 85 86		  sta TMP+1
Source: D:\!Atari\getris2\grat\stars_add.asm
    35
    36 				 mva #sile-1 count
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2ED6 A9 0A		 lda #SILE-1
     2 00,2ED8 8D F8 2E		 sta COUNT
Source: D:\!Atari\getris2\grat\stars_add.asm
    37
    38 00,2EDB			loop
    39 00,2EDB A0 02		 ldy #tstars_dta.faza
    40 00,2EDD AD 0A D2		 lda $d20a
    41 00,2EE0 29 07		 and #7				; dzieki temu gwiazdki pojawiaja sie w roznym tempie
    42 00,2EE2 91 85		 sta (tmp),y
    43
    44 00,2EE4 A0 00		 ldy #tstars_dta.addr		; zerujemy gwiazdke na tej pozycji Y
    45 00,2EE6 A9 0A		 lda <stars_0
    46 00,2EE8 91 85		 sta (tmp),y
    47 00,2EEA C8		 iny
    48 00,2EEB A9 30		 lda >stars_0
    49 00,2EED 91 85		 sta (tmp),y 
    50
    51 00,2EEF 20 E5 2F		 jsr add_tmp
    52
    53 00,2EF2 CE F8 2E		 dec count
    54 00,2EF5 10 E4		 bpl loop
    55 00,2EF7 60		 rts
    56
    57 00,2EF8 00		count	brk
    58 				.endp
    59
    60
    61
    62 00,2EF9			.proc STARS_LOSUJ
    63
    64 = 00,0087		msk equ tmp+2
    65 = 00,0089		hps equ msk+2
    66
    67 				 mwa #maska msk
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2EF9 A9 C2		  lda <MASKA
     3 00,2EFB 85 87		  sta MSK
     4 00,2EFD A9 30		  lda >MASKA
     5 00,2EFF 85 88		  sta MSK+1
Source: D:\!Atari\getris2\grat\stars_add.asm
    68
    69 				 mwa #tstars tmp
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2F01 A9 82		  lda <TSTARS
     3 00,2F03 85 85		  sta TMP
     4 00,2F05 A9 30		  lda >TSTARS
     5 00,2F07 85 86		  sta TMP+1
Source: D:\!Atari\getris2\grat\stars_add.asm
    70
    71 				 mva #0 count
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2F09 A9 00		 lda #0
     2 00,2F0B 8D 84 2F		 sta COUNT
Source: D:\!Atari\getris2\grat\stars_add.asm
    72
    73 00,2F0E			loop
    74 00,2F0E A0 02		 ldy #tstars_dta.faza
    75 00,2F10 B1 85		 lda (tmp),y
    76 00,2F12 F0 07		 beq _ok
    77 00,2F14 C9 08		 cmp #8
    78 00,2F16 B0 03		 bcs _ok
    79 00,2F18 4C 6B 2F		 jmp _skip
    80
    81 00,2F1B			_ok
    82 00,2F1B A0 00		 ldy #tstars_dta.addr		; zerujemy gwiazdke na tej pozycji Y
    83 00,2F1D A9 0A		 lda <stars_0
    84 00,2F1F 91 85		 sta (tmp),y
    85 00,2F21 C8		 iny
    86 00,2F22 A9 30		 lda >stars_0
    87 00,2F24 91 85		 sta (tmp),y
    88
    89 00,2F26 A0 02		 ldy #tstars_dta.faza
    90 00,2F28 AD 0A D2		 lda $d20a
    91 00,2F2B 29 07		 and #7				; dzieki temu gwiazdki pojawiaja sie w roznym tempie
    92 00,2F2D 91 85		 sta (tmp),y
    93
    94 				; lda $d20a
    95 				; bpl _skip
    96
    97 00,2F2F AD 0A D2		 lda $d20a
    98 00,2F32 29 07		 and #7
    99 00,2F34 A8		 tay
   100
   101 00,2F35 B1 87		 lda (msk),y		; wylosowalismy nowa pozycje
   102 00,2F37 F0 32		 beq _skip
   103
   104 00,2F39 98		 tya
   105 00,2F3A 0A 0A		 :2 asl @
   106 00,2F3C 18		 clc
   107 00,2F3D 69 6C		 adc #108
   108 00,2F3F AA		 tax
   109
   110 00,2F40 AC 84 2F		 ldy count
   111 00,2F43 B9 33 34		 lda lhpos,y
   112 00,2F46 85 89		 sta hps
   113 00,2F48 B9 3E 34		 lda hhpos,y
   114 00,2F4B 85 8A		 sta hps+1
   115
   116 00,2F4D A0 01		 ldy #1
   117 00,2F4F 8A		 txa
   118 00,2F50 91 89		 sta (hps),y
   119
   120 				; ldy #tstars_dta.posx
   121 				; sta (tmp),y
   122
   123 00,2F52 AD 0A D2		 lda $d20a
   124 00,2F55 29 03		 and #3
   125 00,2F57 AA		 tax
   126
   127 00,2F58 A0 00		 ldy #tstars_dta.addr
   128 00,2F5A BD AF 30		 lda l_stars,x
   129 00,2F5D 91 85		 sta (tmp),y
   130 00,2F5F C8		 iny
   131 00,2F60 BD B3 30		 lda h_stars,x
   132 00,2F63 91 85		 sta (tmp),y
   133
   134 00,2F65 A0 02		 ldy #tstars_dta.faza
   135 00,2F67 A9 00		 lda #0
   136 00,2F69 91 85		 sta (tmp),y
   137
   138 00,2F6B			_skip
   139
   140 00,2F6B 20 E5 2F		 jsr add_tmp
   141
   142 00,2F6E A5 87		 lda msk
   143 00,2F70 18		 clc
   144 00,2F71 69 08		 adc #8
   145 00,2F73 85 87		 sta msk
   146 00,2F75 90 02		 scc$2F79
   147 00,2F77 E6 88		 inc msk+1
   148
   149 00,2F79 EE 84 2F		 inc count
   150 00,2F7C AD 84 2F		 lda count
   151 00,2F7F C9 0B		 cmp #sile
   152 00,2F81 D0 8B		 bne loop
   153 00,2F83 60		 rts
   154
   155 00,2F84 00		count	brk
   156 				.endp
   157
   158
   159
   160 00,2F85			.proc STARS_ANIMUJ
   161
   162 				// zero page declaractions
   163 = 00,0087		s_addr	equ tmp+2
   164 				;s_faza	equ s_addr+1
   165 				;s_posx	equ s_faza+1
   166
   167 				// program
   168 				 mwa #tstars tmp
Macro: MWA [Source: D:\!Atari\getris2\grat\grat.mac]
     2 00,2F85 A9 82		  lda <TSTARS
     3 00,2F87 85 85		  sta TMP
     4 00,2F89 A9 30		  lda >TSTARS
     5 00,2F8B 85 86		  sta TMP+1
Source: D:\!Atari\getris2\grat\stars_add.asm
   169
   170 				 mva #0 count
Macro: MVA [Source: D:\!Atari\getris2\grat\grat.mac]
     1 00,2F8D A9 00		 lda #0
     2 00,2F8F 8D E4 2F		 sta COUNT
Source: D:\!Atari\getris2\grat\stars_add.asm
   171
   172 00,2F92			loop
   173 00,2F92 A0 02		 ldy #tstars_dta.faza
   174 00,2F94 B1 85		 lda (tmp),y
   175 00,2F96 C9 08		 cmp #8
   176 00,2F98 B0 3C		 bcs _skip
   177
   178 00,2F9A A0 00		 ldy #tstars_dta.addr
   179 00,2F9C B1 85		 lda (tmp),y
   180 00,2F9E 85 87		 sta s_addr
   181 00,2FA0 C8		 iny
   182 00,2FA1 B1 85		 lda (tmp),y
   183 00,2FA3 85 88		 sta s_addr+1
   184
   185 00,2FA5 A0 02		 ldy #tstars_dta.faza
   186 00,2FA7 B1 85		 lda (tmp),y
   187 00,2FA9 AA		 tax
   188 00,2FAA 18		 clc
   189 00,2FAB 69 01		 adc #1
   190 00,2FAD 91 85		 sta (tmp),y
   191
   192 00,2FAF BC A6 30		 ldy tmul5,x
   193
   194 00,2FB2 AE E4 2F		 ldx count
   195 00,2FB5 BD B7 30		 lda posy,x
   196 00,2FB8 AA		 tax
   197
   198 00,2FB9 B1 87		 lda (s_addr),y
   199 00,2FBB 9D 00 04		 sta pmg_stars+$400,x
   200 00,2FBE C8		 iny
   201 00,2FBF B1 87		 lda (s_addr),y
   202 00,2FC1 9D 01 04		 sta pmg_stars+$401,x
   203 00,2FC4 C8		 iny
   204 00,2FC5 B1 87		 lda (s_addr),y
   205 00,2FC7 9D 02 04		 sta pmg_stars+$402,x
   206 00,2FCA C8		 iny
   207 00,2FCB B1 87		 lda (s_addr),y
   208 00,2FCD 9D 03 04		 sta pmg_stars+$403,x
   209 00,2FD0 C8		 iny
   210 00,2FD1 B1 87		 lda (s_addr),y
   211 00,2FD3 9D 04 04		 sta pmg_stars+$404,x
   212
   213 00,2FD6			_skip
   214
   215 00,2FD6 20 E5 2F		 jsr add_tmp
   216
   217 00,2FD9 EE E4 2F		 inc count
   218 00,2FDC AD E4 2F		 lda count
   219 00,2FDF C9 0B		 cmp #sile
   220 00,2FE1 D0 AF		 bne loop
   221 00,2FE3 60		 rts 
   222
   223 00,2FE4 00		count	brk
   224 				.endp
   225
   226
   227 00,2FE5			.proc ADD_TMP
   228
   229 00,2FE5 A5 85		 lda tmp
   230 00,2FE7 18		 clc
   231 00,2FE8 69 03		 adc #tstars_dta	 ; structure TSTARS_DTA length
   232 00,2FEA 85 85		 sta tmp
   233 00,2FEC 90 02		 scc$2FF0
   234 00,2FEE E6 86		 inc tmp+1
   235 00,2FF0 60		 rts
   236
   237 				.endp
   238
   239 				;---
   240
   241 				// animacje gwiazdek STARS1, STARS2, STARS3
   242 				// 8 klatek po 5 bajtow kazda
   243 00,2FF1			stars1
   244 00,2FF1 00		 dta %00000000
   245 00,2FF2 00		 dta %00000000
   246 00,2FF3 04		 dta %00000100
   247 00,2FF4 00		 dta %00000000
   248 00,2FF5 00		 dta %00000000
   249
   250 00,2FF6 00		 dta %00000000
   251 00,2FF7 04		 dta %00000100
   252 00,2FF8 0E		 dta %00001110
   253 00,2FF9 04		 dta %00000100
   254 00,2FFA 00		 dta %00000000
   255
   256 00,2FFB 04		 dta %00000100
   257 00,2FFC 04		 dta %00000100
   258 00,2FFD 1F		 dta %00011111
   259 00,2FFE 04		 dta %00000100
   260 00,2FFF 04		 dta %00000100
   261
   262 00,3000 00		 dta %00000000
   263 00,3001 04		 dta %00000100
   264 00,3002 0E		 dta %00001110
   265 00,3003 04		 dta %00000100
   266 00,3004 00		 dta %00000000
   267
   268 00,3005 00		 dta %00000000
   269 00,3006 00		 dta %00000000
   270 00,3007 04		 dta %00000100
   271 00,3008 00		 dta %00000000
   272 00,3009 00		 dta %00000000
   273
   274 00,300A			stars_0
   275 00,300A 00 00 00 00 00 +	 :40 brk
   276
   277
   278 00,3032			stars2
   279 00,3032 00		 dta %00000000
   280 00,3033 00		 dta %00000000
   281 00,3034 04		 dta %00000100
   282 00,3035 00		 dta %00000000
   283 00,3036 00		 dta %00000000
   284
   285 00,3037 00		 dta %00000000
   286 00,3038 04		 dta %00000100
   287 00,3039 0E		 dta %00001110
   288 00,303A 04		 dta %00000100
   289 00,303B 00		 dta %00000000
   290
   291 00,303C 04		 dta %00000100
   292 00,303D 04		 dta %00000100
   293 00,303E 0E		 dta %00001110
   294 00,303F 04		 dta %00000100
   295 00,3040 04		 dta %00000100
   296
   297 00,3041 00		 dta %00000000
   298 00,3042 04		 dta %00000100
   299 00,3043 1F		 dta %00011111
   300 00,3044 04		 dta %00000100
   301 00,3045 00		 dta %00000000
   302
   303 00,3046 00		 dta %00000000
   304 00,3047 04		 dta %00000100
   305 00,3048 0E		 dta %00001110
   306 00,3049 04		 dta %00000100
   307 00,304A 00		 dta %00000000
   308
   309 00,304B 00		 dta %00000000
   310 00,304C 00		 dta %00000000
   311 00,304D 04		 dta %00000100
   312 00,304E 00		 dta %00000000
   313 00,304F 00		 dta %00000000
   314
   315 00,3050 00 00 00 00 00 +	 :10 brk
   316
   317
   318 00,305A			stars3
   319 00,305A 00		 dta %00000000
   320 00,305B 00		 dta %00000000
   321 00,305C 04		 dta %00000100
   322 00,305D 00		 dta %00000000
   323 00,305E 00		 dta %00000000
   324
   325 00,305F 00		 dta %00000000
   326 00,3060 0A		 dta %00001010
   327 00,3061 04		 dta %00000100
   328 00,3062 0A		 dta %00001010
   329 00,3063 00		 dta %00000000
   330
   331 00,3064 10		 dta %00010000
   332 00,3065 0A		 dta %00001010
   333 00,3066 04		 dta %00000100
   334 00,3067 0A		 dta %00001010
   335 00,3068 01		 dta %00000001
   336
   337 00,3069 11		 dta %00010001
   338 00,306A 0A		 dta %00001010
   339 00,306B 04		 dta %00000100
   340 00,306C 0A		 dta %00001010
   341 00,306D 11		 dta %00010001
   342
   343 00,306E 01		 dta %00000001
   344 00,306F 0A		 dta %00001010
   345 00,3070 04		 dta %00000100
   346 00,3071 0A		 dta %00001010
   347 00,3072 10		 dta %00010000
   348
   349 00,3073 00		 dta %00000000
   350 00,3074 0A		 dta %00001010
   351 00,3075 04		 dta %00000100
   352 00,3076 0A		 dta %00001010
   353 00,3077 00		 dta %00000000
   354
   355 00,3078 00		 dta %00000000
   356 00,3079 00		 dta %00000000
   357 00,307A 04		 dta %00000100
   358 00,307B 00		 dta %00000000
   359 00,307C 00		 dta %00000000
   360
   361 00,307D 00 00 00 00 00	 :5 brk
   362
   363
   364
   365 				;---
   366
   367 				// tablica z opisem 11 pozycji gwiazdek
   368
   369 00,3082			.struct tstars_dta
   370 = 00,0000		addr .word
   371 = 00,0002		faza .byte
   372 				.ends
   373
   374 00,3082 0A 30 00 0A 30 +	tstars dta tstars_dta [sile] (stars_0,0)
   375
   376 00,30A6 00 05 0A 0F 14 +	tmul5  dta 0,5,10,15,20,25,30,35,40
   377
   378 00,30AF F1 32 5A 32	l_stars dta l( stars1, stars2 , stars3 , stars2 )
   379 00,30B3 2F 30 30 30	h_stars dta h( stars1, stars2 , stars3 , stars2 )
   380
   381 				// pozycja pionowa ducha (11 pozycji co 8 linii)
   382 00,30B7			posy
   383 				.rept sile
   384 				 dta 40+.r*8
   385 				.endr
Source: REPT
   384 00,30B7 #00 28		 dta 40+.r*8
   384 00,30B8 #01 30		 dta 40+.r*8
   384 00,30B9 #02 38		 dta 40+.r*8
   384 00,30BA #03 40		 dta 40+.r*8
   384 00,30BB #04 48		 dta 40+.r*8
   384 00,30BC #05 50		 dta 40+.r*8
   384 00,30BD #06 58		 dta 40+.r*8
   384 00,30BE #07 60		 dta 40+.r*8
   384 00,30BF #08 68		 dta 40+.r*8
   384 00,30C0 #09 70		 dta 40+.r*8
   384 00,30C1 #0A 78		 dta 40+.r*8
Source: D:\!Atari\getris2\grat\stars_add.asm
   386
   387
   388 				// maska wczytana od tylu, bo licznik COUNT zliczamy od tylu
   389 00,30C2			maska
   390 				.rept 11
   391 				 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   392 				.endr
Source: REPT
   391 00,30C2 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30CA 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30D2 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30DA 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30E2 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30EA 00 00 01 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30F2 00 01 01 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,30FA 00 00 01 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,3102 00 00 00 00 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,310A 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
   391 00,3112 00 00 00 01 01 +	 ins 'grat_logos_maska_ok.scr',12+.r*32,8
Source: D:\!Atari\getris2\grat\stars_add.asm
  1265
  1266 00,311A			 icl 'grat.fad'
Source: D:\!Atari\getris2\grat\grat.fad
     1 = 00,0069		color_nr equ 105
     2
     3 				;-----------;
     4 				;-  WAIT   -;
     5 				;-----------;
     6 00,311A			.proc wait
     7 				 lda:cmp:req cloc
     7 00,311A A5 14		 lda cloc
     7 00,311C C5 14		 cmp cloc
     7 00,311E F0 FC		 req$311C cloc
     8 00,3120 CA		 dex
     9 00,3121 D0 F7		 bne wait
    10 00,3123 60		 rts
    11 				.endp
    12
    13 				;-----------;
    14 				;-  FADE   -;
    15 				;-----------;
    16 00,3124			.proc fade
    17 00,3124 8E 3A 31		 stx adr+1
    18 00,3127 8C 3B 31		 sty adr+2
    19
    20 00,312A A2 06		 ldx #6
    21 00,312C 20 1A 31		 jsr wait
    22
    23 00,312F A9 10		 lda #16
    24 00,3131 8D 42 31		 sta licz
    25 00,3134			fad
    26 00,3134 A2 02		 ldx #2
    27 00,3136 20 1A 31		 jsr wait
    28
    29 00,3139 20 FF FF		adr jsr $ffff
    30
    31 00,313C CE 42 31		 dec licz
    32 00,313F D0 F3		 bne fad
    33 00,3141 60		 rts
    34
    35 00,3142 00		licz	.BYTE
    36 				.endp
    37
    38 				;-----------;
    39 				;- FADE IN -;
    40 				;-----------;
    41 00,3143			.proc fade_in
    42
    43 00,3143 A2 4A		 ldx <fade
    44 00,3145 A0 31		 ldy >fade
    45 00,3147 4C 24 31		 jmp :fade
    46
    47 00,314A			fade
    48
    49 00,314A A9 8F		 lda <tab.l_tcol
    50 00,314C 8D 78 31		 sta adr0+1
    51 00,314F A9 F8		 lda <tab.h_tcol
    52 00,3151 8D 7D 31		 sta adr1+1
    53 00,3154 A9 61		 lda <tab.t_satur
    54 00,3156 8D 96 31		 sta adr2+1
    55 00,3159 A9 CA		 lda <tab.t_color
    56 00,315B 8D 89 31		 sta adr3+1
    57
    58 00,315E A9 32		 lda >tab.l_tcol
    59 00,3160 8D 79 31		 sta adr0+2
    60 00,3163 A9 32		 lda >tab.h_tcol
    61 00,3165 8D 7E 31		 sta adr1+2
    62 00,3168 A9 33		 lda >tab.t_satur
    63 00,316A 8D 97 31		 sta adr2+2
    64 00,316D A9 33		 lda >tab.t_color
    65 00,316F 8D 8A 31		 sta adr3+2
    66
    67 00,3172 A2 00		 ldx #0
    68 00,3174 8E BE 31		 stx count
    69
    70 00,3177			fade_l
    71 00,3177 BD FF FF		adr0 lda $ffff,x
    72 00,317A 85 80		 sta ftmp
    73 00,317C BD FF FF		adr1 lda $ffff,x
    74 00,317F 85 81		 sta ftmp+1
    75
    76 00,3181 A0 01		 ldy #1
    77 00,3183 B1 80		 lda (ftmp),y
    78 00,3185 A8		 tay
    79
    80 00,3186 29 F0		 and #$f0
    81 00,3188 DD FF FF		adr3 cmp $ffff,x
    82 00,318B F0 05		 beq skp1
    83
    84 00,318D 98		 tya
    85 00,318E 18		 clc
    86 00,318F 69 10		 adc #$10
    87 00,3191 A8		 tay
    88
    89 00,3192			skp1
    90
    91 00,3192 98		 tya
    92 00,3193 29 0F		 and #$0f
    93 00,3195 DD FF FF		adr2 cmp $ffff,x
    94 00,3198 F0 01		 beq skp0
    95
    96 00,319A C8		 iny
    97
    98 00,319B			skp0
    99
   100 00,319B 98		 tya
   101 00,319C A0 01		 ldy #1
   102 00,319E 91 80		 sta (ftmp),y
   103
   104 00,31A0 E8		 inx
   105 00,31A1 D0 0F		 bne skp
   106 00,31A3 EE BE 31		 inc count
   107
   108 00,31A6 EE 79 31		 inc adr0+2
   109 00,31A9 EE 7E 31		 inc adr1+2
   110 00,31AC EE 97 31		 inc adr2+2
   111 00,31AF EE 8A 31		 inc adr3+2
   112
   113 00,31B2			skp
   114
   115 00,31B2 E0 69		 cpx <color_nr
   116 00,31B4 D0 C1		 bne fade_l
   117 00,31B6 AD BE 31		 lda count
   118 00,31B9 C9 00		 cmp >color_nr
   119 00,31BB D0 BA		 bne fade_l
   120 00,31BD 60		 rts
   121
   122 00,31BE 00		count	.BYTE
   123 				.endp
   124
   125 				;------------;
   126 				;- FADE OUT -;
   127 				;------------;
   128 00,31BF			.proc fade_out
   129
   130 00,31BF A2 C6		 ldx <fade
   131 00,31C1 A0 31		 ldy >fade
   132 00,31C3 4C 24 31		 jmp :fade
   133
   134 00,31C6			fade
   135
   136 00,31C6 A9 8F		 lda <tab.l_tcol
   137 00,31C8 8D E0 31		 sta adr0+1
   138 00,31CB A9 F8		 lda <tab.h_tcol
   139 00,31CD 8D E5 31		 sta adr1+1
   140
   141 00,31D0 A9 32		 lda >tab.l_tcol
   142 00,31D2 8D E1 31		 sta adr0+2
   143 00,31D5 A9 32		 lda >tab.h_tcol
   144 00,31D7 8D E6 31		 sta adr1+2
   145
   146 00,31DA A2 00		 ldx #0
   147 00,31DC 8E 24 32		 stx count
   148
   149 00,31DF			fade_l
   150 00,31DF BD 8F 32		adr0 lda tab.l_tcol,x
   151 00,31E2 85 80		 sta ftmp
   152 00,31E4 BD F8 32		adr1 lda tab.h_tcol,x
   153 00,31E7 85 81		 sta ftmp+1
   154
   155 00,31E9 A0 01		 ldy #1
   156 00,31EB B1 80		 lda (ftmp),y
   157 00,31ED A8		 tay
   158
   159 00,31EE 29 0F		 and #$0f
   160 00,31F0 F0 01		 beq skp0
   161
   162 00,31F2 88		 dey
   163
   164 00,31F3			skp0
   165
   166 00,31F3 98		 tya
   167 00,31F4 29 F0		 and #$f0
   168 00,31F6 F0 05		 beq skp1
   169
   170 00,31F8 98		 tya
   171 00,31F9 38		 sec
   172 00,31FA E9 10		 sbc #$10
   173 00,31FC A8		 tay
   174
   175 00,31FD			skp1
   176 00,31FD 98		 tya
   177
   178 00,31FE A0 01		 ldy #1
   179 00,3200 91 80		 sta (ftmp),y
   180
   181 00,3202 E8		 inx
   182 00,3203 D0 09		 bne skp
   183 00,3205 EE 24 32		 inc count
   184
   185 00,3208 EE E1 31		 inc adr0+2
   186 00,320B EE E6 31		 inc adr1+2
   187
   188 00,320E			skp
   189
   190 00,320E E0 69		 cpx <color_nr
   191 00,3210 D0 CD		 bne fade_l
   192 00,3212 AD 24 32		 lda count
   193 00,3215 C9 00		 cmp >color_nr
   194 00,3217 D0 C6		 bne fade_l
   195
   196 00,3219 A0 07		 ldy #7
   197 00,321B A9 00		 lda #0
   198 00,321D			clr
   199 00,321D 99 00 D0		 sta $d000,y
   200 00,3220 88		 dey
   201 00,3221 10 FA		 bpl clr
   202 00,3223 60		 rts
   203
   204 00,3224 00		count	.BYTE
   205 				.endp
   206
   207 				;--------------;
   208 				;- SAVE COLOR -;
   209 				;--------------;
   210 00,3225			.proc save_color
   211
   212 00,3225 A9 8F		 lda <tab.l_tcol
   213 00,3227 8D 53 32		 sta adr0+1
   214 00,322A A9 F8		 lda <tab.h_tcol
   215 00,322C 8D 58 32		 sta adr1+1
   216 00,322F A9 61		 lda <tab.t_satur
   217 00,3231 8D 64 32		 sta adr2+1
   218 00,3234 A9 CA		 lda <tab.t_color
   219 00,3236 8D 6A 32		 sta adr3+1
   220
   221 00,3239 A9 32		 lda >tab.l_tcol
   222 00,323B 8D 54 32		 sta adr0+2
   223 00,323E A9 32		 lda >tab.h_tcol
   224 00,3240 8D 59 32		 sta adr1+2
   225 00,3243 A9 33		 lda >tab.t_satur
   226 00,3245 8D 65 32		 sta adr2+2
   227 00,3248 A9 33		 lda >tab.t_color
   228 00,324A 8D 6B 32		 sta adr3+2
   229
   230 00,324D A2 00		 ldx #0
   231 00,324F 8E 8E 32		 stx count
   232
   233 00,3252			save_l
   234 00,3252 BD FF FF		adr0 lda $ffff,x
   235 00,3255 85 80		 sta ftmp
   236 00,3257 BD FF FF		adr1 lda $ffff,x
   237 00,325A 85 81		 sta ftmp+1
   238
   239 00,325C A0 01		 ldy #1
   240 00,325E B1 80		 lda (ftmp),y
   241 00,3260 48		 pha
   242 00,3261 29 0F		 and #$0f
   243 00,3263 9D FF FF		adr2 sta $ffff,x
   244 00,3266 68		 pla
   245 00,3267 29 F0		 and #$f0
   246 00,3269 9D FF FF		adr3 sta $ffff,x
   247
   248 00,326C A9 00		 lda #0        ; black screen (all colors = $00)
   249 00,326E 91 80		 sta (ftmp),y
   250
   251 00,3270 E8		 inx
   252 00,3271 D0 0F		 bne skp
   253 00,3273 EE 8E 32		 inc count
   254
   255 00,3276 EE 54 32		 inc adr0+2
   256 00,3279 EE 59 32		 inc adr1+2
   257 00,327C EE 65 32		 inc adr2+2
   258 00,327F EE 6B 32		 inc adr3+2
   259
   260 00,3282			skp
   261
   262 00,3282 E0 69		 cpx <color_nr
   263 00,3284 D0 CC		 bne save_l
   264 00,3286 AD 8E 32		 lda count
   265 00,3289 C9 00		 cmp >color_nr
   266 00,328B D0 C5		 bne save_l
   267 00,328D 60		 rts
   268
   269 00,328E 00		count	.BYTE
   270 				.endp
   271
   272 00,328F			.proc tab
   273 00,328F			l_tcol
   274 00,328F 27 2C 31 36 3B +	 dta l(c0,c1,c2,c3,c4,c5,c6,c7,c8,c9)
   275 00,3299 59 7B AC DD 0E +	 dta l(c10,c11,c12,c13,c14,c15,c16,c17,c18,c19)
   276 00,32A3 B7 E8 19 4A 7B +	 dta l(c20,c21,c22,c23,c24,c25,c26,c27,c28,c29)
   277 00,32AD 86 B7 E8 7A 8E +	 dta l(c30,c31,c32,c33,c34,c35,c36,c37,c38,c39)
   278 00,32B7 AE DE F4 0B 0F +	 dta l(c40,c41,c42,c43,c44,c45,c46,c47,c48)
   279 00,32C0 5E 63 8F 94 C0 +	 dta l(c50,c51,c52,c53,c54,c55,c56,c57,c58,c59)
   280 00,32CA 53 58 84 89 CB +	 dta l(c60,c61,c62,c63,c64,c65,c66,c67,c68,c69)
   281 00,32D4 5E 63 8F 94 C0 +	 dta l(c70,c71,c72,c73,c74,c75,c76,c77,c78,c79)
   282 00,32DE 69 6E 9A 9F CB +	 dta l(c80,c81,c82,c83,c84,c85,c86,c87,c88,c89)
   283 00,32E8 5C 63 A2 A9 D2 +	 dta l(c90,c91,c92,c93,c94,c95,c96,c97,c98,c99)
   284 00,32F2 62 69 92 99 C2 +	 dta l(c100,c101,c102,c103,c104,c105)
   285
   286 00,32F8			h_tcol
   287 00,32F8 2E 2E 2E 2E 2E +	 dta h(c0,c1,c2,c3,c4,c5,c6,c7,c8,c9)
   288 00,3302 27 27 27 27 28 +	 dta h(c10,c11,c12,c13,c14,c15,c16,c17,c18,c19)
   289 00,330C 28 28 29 29 29 +	 dta h(c20,c21,c22,c23,c24,c25,c26,c27,c28,c29)
   290 00,3316 2A 2A 2A 2B 2B +	 dta h(c30,c31,c32,c33,c34,c35,c36,c37,c38,c39)
   291 00,3320 2C 2C 2C 2D 2D +	 dta h(c40,c41,c42,c43,c44,c45,c46,c47,c48)
   292 00,3329 27 27 27 27 27 +	 dta h(c50,c51,c52,c53,c54,c55,c56,c57,c58,c59)
   293 00,3333 28 28 28 28 28 +	 dta h(c60,c61,c62,c63,c64,c65,c66,c67,c68,c69)
   294 00,333D 29 29 29 29 29 +	 dta h(c70,c71,c72,c73,c74,c75,c76,c77,c78,c79)
   295 00,3347 2A 2A 2A 2A 2A +	 dta h(c80,c81,c82,c83,c84,c85,c86,c87,c88,c89)
   296 00,3351 2B 2B 2B 2B 2B +	 dta h(c90,c91,c92,c93,c94,c95,c96,c97,c98,c99)
   297 00,335B 2C 2C 2C 2C 2C +	 dta h(c100,c101,c102,c103,c104,c105)
   298
   299 00,3361			t_satur org *+color_nr
   300 00,33CA			t_color org *+color_nr
   301 				.endp
  1267
  1268 00,3433-48F8> 81 B2 C1 +	lhpos dta l(h0_,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9)
  1269 00,343E 2E 26 26 26 26 +	hhpos dta h(h0_,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9)
  1270
  1271 				*--- CMC module
  1272
  1273 00,3449			.local cmc
  1274
  1275 = 00,3449		music	equ *
  1276
  1277 = 00,0000		DEFSONG	equ 0
  1278
  1279
  1280 					cmc_relocator 'msx_cmc\hlejnia.cmc' , music
Macro: CMC_RELOCATOR [Source: D:\!Atari\getris2\grat\msx_cmc\cmc_relocator.mac]
     2 00,3449				.get 'msx_cmc\hlejnia.cmc'					
     7 = 00,3449		new_add equ MUSIC					
     9 = 00,8400		old_add	equ .get[2] + .get[3]<<8		
    11 = 00,0D42			?length	equ .get[4] + .get[5]<<8 - old_add + 1	
    13  [0002] 49			.put[2] = .lo(new_add)				
    14  [0003] 34			.put[3] = .hi(new_add)				
    16  [0004] 8A			.put[4] = .lo(new_add + ?length - 1)		
    17  [0005] 41			.put[5] = .hi(new_add + ?length - 1)
    19 = 00,0006		ofs	equ 6
    24 = 00,8700			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3749			?hlp = ?tmp - old_add + new_add
    27  #00 [001A] 49			.put[ofs+$14+.r] = .lo(?hlp)
    28  #00 [005A] 37			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,890E			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3957			?hlp = ?tmp - old_add + new_add
    27  #01 [001B] 57			.put[ofs+$14+.r] = .lo(?hlp)
    28  #01 [005B] 39			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8E27			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3E70			?hlp = ?tmp - old_add + new_add
    27  #02 [001C] 70			.put[ofs+$14+.r] = .lo(?hlp)
    28  #02 [005C] 3E			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8E53			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3E9C			?hlp = ?tmp - old_add + new_add
    27  #03 [001D] 9C			.put[ofs+$14+.r] = .lo(?hlp)
    28  #03 [005D] 3E			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8742			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,378B			?hlp = ?tmp - old_add + new_add
    27  #04 [001E] 8B			.put[ofs+$14+.r] = .lo(?hlp)
    28  #04 [005E] 37			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8784			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,37CD			?hlp = ?tmp - old_add + new_add
    27  #05 [001F] CD			.put[ofs+$14+.r] = .lo(?hlp)
    28  #05 [005F] 37			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,87C6			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,380F			?hlp = ?tmp - old_add + new_add
    27  #06 [0020] 0F			.put[ofs+$14+.r] = .lo(?hlp)
    28  #06 [0060] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,87E7			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3830			?hlp = ?tmp - old_add + new_add
    27  #07 [0021] 30			.put[ofs+$14+.r] = .lo(?hlp)
    28  #07 [0061] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8804			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,384D			?hlp = ?tmp - old_add + new_add
    27  #08 [0022] 4D			.put[ofs+$14+.r] = .lo(?hlp)
    28  #08 [0062] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,88EB			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3934			?hlp = ?tmp - old_add + new_add
    27  #09 [0023] 34			.put[ofs+$14+.r] = .lo(?hlp)
    28  #09 [0063] 39			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8825			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,386E			?hlp = ?tmp - old_add + new_add
    27  #0A [0024] 6E			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0A [0064] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8867			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,38B0			?hlp = ?tmp - old_add + new_add
    27  #0B [0025] B0			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0B [0065] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,88A9			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,38F2			?hlp = ?tmp - old_add + new_add
    27  #0C [0026] F2			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0C [0066] 38			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8E81			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3ECA			?hlp = ?tmp - old_add + new_add
    27  #0D [0027] CA			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0D [0067] 3E			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8DE5			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3E2E			?hlp = ?tmp - old_add + new_add
    27  #0E [0028] 2E			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0E [0068] 3E			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8FA4			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3FED			?hlp = ?tmp - old_add + new_add
    27  #0F [0029] ED			.put[ofs+$14+.r] = .lo(?hlp)
    28  #0F [0069] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8950			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3999			?hlp = ?tmp - old_add + new_add
    27  #10 [002A] 99			.put[ofs+$14+.r] = .lo(?hlp)
    28  #10 [006A] 39			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8992			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,39DB			?hlp = ?tmp - old_add + new_add
    27  #11 [002B] DB			.put[ofs+$14+.r] = .lo(?hlp)
    28  #11 [006B] 39			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,89D4			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3A1D			?hlp = ?tmp - old_add + new_add
    27  #12 [002C] 1D			.put[ofs+$14+.r] = .lo(?hlp)
    28  #12 [006C] 3A			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8A16			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3A5F			?hlp = ?tmp - old_add + new_add
    27  #13 [002D] 5F			.put[ofs+$14+.r] = .lo(?hlp)
    28  #13 [006D] 3A			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8A3B			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3A84			?hlp = ?tmp - old_add + new_add
    27  #14 [002E] 84			.put[ofs+$14+.r] = .lo(?hlp)
    28  #14 [006E] 3A			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8ABC			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3B05			?hlp = ?tmp - old_add + new_add
    27  #15 [002F] 05			.put[ofs+$14+.r] = .lo(?hlp)
    28  #15 [006F] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8A71			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3ABA			?hlp = ?tmp - old_add + new_add
    27  #16 [0030] BA			.put[ofs+$14+.r] = .lo(?hlp)
    28  #16 [0070] 3A			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8AE0			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3B29			?hlp = ?tmp - old_add + new_add
    27  #17 [0031] 29			.put[ofs+$14+.r] = .lo(?hlp)
    28  #17 [0071] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8B23			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3B6C			?hlp = ?tmp - old_add + new_add
    27  #18 [0032] 6C			.put[ofs+$14+.r] = .lo(?hlp)
    28  #18 [0072] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8AFC			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3B45			?hlp = ?tmp - old_add + new_add
    27  #19 [0033] 45			.put[ofs+$14+.r] = .lo(?hlp)
    28  #19 [0073] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8F1F			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3F68			?hlp = ?tmp - old_add + new_add
    27  #1A [0034] 68			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1A [0074] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8B43			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3B8C			?hlp = ?tmp - old_add + new_add
    27  #1B [0035] 8C			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1B [0075] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8EDD			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3F26			?hlp = ?tmp - old_add + new_add
    27  #1C [0036] 26			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1C [0076] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8B85			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3BCE			?hlp = ?tmp - old_add + new_add
    27  #1D [0037] CE			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1D [0077] 3B			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8BC7			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3C10			?hlp = ?tmp - old_add + new_add
    27  #1E [0038] 10			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1E [0078] 3C			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8C09			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3C52			?hlp = ?tmp - old_add + new_add
    27  #1F [0039] 52			.put[ofs+$14+.r] = .lo(?hlp)
    28  #1F [0079] 3C			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8C4B			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3C94			?hlp = ?tmp - old_add + new_add
    27  #20 [003A] 94			.put[ofs+$14+.r] = .lo(?hlp)
    28  #20 [007A] 3C			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8CCF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3D18			?hlp = ?tmp - old_add + new_add
    27  #21 [003B] 18			.put[ofs+$14+.r] = .lo(?hlp)
    28  #21 [007B] 3D			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8C8D			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3CD6			?hlp = ?tmp - old_add + new_add
    27  #22 [003C] D6			.put[ofs+$14+.r] = .lo(?hlp)
    28  #22 [007C] 3C			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8D11			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3D5A			?hlp = ?tmp - old_add + new_add
    27  #23 [003D] 5A			.put[ofs+$14+.r] = .lo(?hlp)
    28  #23 [007D] 3D			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8D53			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3D9C			?hlp = ?tmp - old_add + new_add
    27  #24 [003E] 9C			.put[ofs+$14+.r] = .lo(?hlp)
    28  #24 [007E] 3D			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8D70			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3DB9			?hlp = ?tmp - old_add + new_add
    27  #25 [003F] B9			.put[ofs+$14+.r] = .lo(?hlp)
    28  #25 [007F] 3D			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8EB3			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3EFC			?hlp = ?tmp - old_add + new_add
    27  #26 [0040] FC			.put[ofs+$14+.r] = .lo(?hlp)
    28  #26 [0080] 3E			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8DA8			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3DF1			?hlp = ?tmp - old_add + new_add
    27  #27 [0041] F1			.put[ofs+$14+.r] = .lo(?hlp)
    28  #27 [0081] 3D			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8F8C			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3FD5			?hlp = ?tmp - old_add + new_add
    27  #28 [0042] D5			.put[ofs+$14+.r] = .lo(?hlp)
    28  #28 [0082] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8F79			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3FC2			?hlp = ?tmp - old_add + new_add
    27  #29 [0043] C2			.put[ofs+$14+.r] = .lo(?hlp)
    28  #29 [0083] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8F37			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,3F80			?hlp = ?tmp - old_add + new_add
    27  #2A [0044] 80			.put[ofs+$14+.r] = .lo(?hlp)
    28  #2A [0084] 3F			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,903B			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,4084			?hlp = ?tmp - old_add + new_add
    27  #2B [0045] 84			.put[ofs+$14+.r] = .lo(?hlp)
    28  #2B [0085] 40			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,8FE6			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,402F			?hlp = ?tmp - old_add + new_add
    27  #2C [0046] 2F			.put[ofs+$14+.r] = .lo(?hlp)
    28  #2C [0086] 40			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,9094			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,40DD			?hlp = ?tmp - old_add + new_add
    27  #2D [0047] DD			.put[ofs+$14+.r] = .lo(?hlp)
    28  #2D [0087] 40			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,90EA			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    26 = 00,4133			?hlp = ?tmp - old_add + new_add
    27  #2E [0048] 33			.put[ofs+$14+.r] = .lo(?hlp)
    28  #2E [0088] 41			.put[ofs+$54+.r] = .hi(?hlp)
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
    24 = 00,FFFF			?tmp = .get[ofs+$14+.r] + .get[ofs+$54+.r]<<8
Source: D:\!Atari\getris2\grat\grat.asm
  1281
  1282 00,3449 A0 E3 ED E3 A0 +		.sav [6] ?length
  1283
  1284 00,418B			init
  1285 00,418B A9 70			lda #$70
  1286 00,418D A2 49			ldx #<MUSIC
  1287 00,418F A0 34			ldy #>MUSIC
  1288 00,4191 20 9F 41			jsr PLAYERCMC+3
  1289 00,4194 A9 00			lda #$00
  1290 00,4196 A2 00			ldx #DEFSONG
  1291 00,4198 20 9F 41			jsr PLAYERCMC+3
  1292 00,419B 60			rts
  1293
  1294 00,419C				icl 'msx_cmc\playcmc.asm'
Source: D:\!Atari\getris2\grat\msx_cmc\playcmc.asm
     1 				*---------------------------*
     2 				*     cmc player v 2.1      *
     3 				*   by Marcin Lewandowski   *
     4 				* based on cmc player v 2.0 *
     5 				*      by Janusz Pelc       *
     6 				*---------------------------*
     7
     8 00,419C			.proc playerCMC
     9
    10 				*--- tablica basu (chyba)
    11
    12 = 00,0001		bass equ 1
    13
    14 				*--- strona 0
    15
    16 = 00,00FC		addr equ $fc
    17 = 00,00FE		word equ $fe
    18
    19 				*--- skoki
    20
    21 00,419C 4C 9C 41		 jmp *		;basic
    22 00,419F 4C 02 42		 jmp init
    23 00,41A2 4C 55 44		 jmp play
    24
    25 				*--- dane
    26
    27 00,41A5 00 00 00		volume dta d'   '
    28 00,41A8 00 00 00		czest  dta d'   '
    29 00,41AB 00 00 00		numins dta d'   '
    30
    31 				; dta c' cmc player v 2.1 '*
    32
    33 00,41AE 00 00 00 00	frq    dta d'    '
    34 00,41B2 00 00 00 00	znieks dta d'    '
    35 00,41B6 00		audc   dta b(0)
    36
    37 00,41B7 00 00 00		czest1 dta d'   '
    38 00,41BA 00 00 00		czest2 dta d'   '
    39 00,41BD 00 00 00		czest3 dta d'   '
    40 00,41C0 00 00 00		zniek  dta d'   '
    41 00,41C3 FF FF FF		count1 dta b($ff),b($ff),b($ff)
    42 00,41C6 00 00 00		count2 dta d'   '
    43 00,41C9 00 00 00		lopad  dta d'   '
    44 00,41CC 00 00 00		numptr dta d'   '
    45 00,41CF 00 00 00		poswpt dta d'   '
    46 00,41D2 00 00 00		ilewol dta d'   '
    47 00,41D5 80 80 80		czygrx dta b($80),b($80),b($80)
    48 00,41D8 80		czygrc dta b($80)
    49
    50 00,41D9 00 00 00		dana0  dta d'   '
    51 00,41DC 00 00 00		dana1  dta d'   '
    52 00,41DF 00 00 00		dana2  dta d'   '
    53 00,41E2 00 00 00		dana3  dta d'   '
    54 00,41E5 00 00 00		dana4  dta d'   '
    55 00,41E8 00 00 00		dana5  dta d'   '
    56 00,41EB 00 00 00		ladr   dta d'   '
    57 00,41EE 00 00 00		hadr   dta d'   '
    58
    59 00,41F1 00		posptr dta b(0)
    60 00,41F2 00		possng dta b(0)
    61 00,41F3 00		pocrep dta b(0)
    62 00,41F4 00		konrep dta b(0)
    63 00,41F5 00		ilrep  dta b(0)
    64 00,41F6 00		tmpo   dta b(0)
    65 00,41F7 00		ltemp  dta b(0)
    66 00,41F8 00		b1     dta b(0)
    67 00,41F9 00		b2     dta b(0)
    68 00,41FA 00		b3     dta b(0)
    69 00,41FB 00		czygr  dta b(0)
    70
    71 00,41FC 00 00		adrmus dta a(0)
    72 00,41FE 00 00		adradr dta a(0)
    73 00,4200 00 00		adrsng dta a(0)
    74
    75 				*--- init
    76
    77 00,4202 8D F8 41		init sta b1
    78 00,4205 8E F9 41		 stx b2
    79 00,4208 8C FA 41		 sty b3
    80 00,420B 29 70		 and #$70
    81 00,420D 4A		 lsr @
    82 00,420E 4A		 lsr @
    83 00,420F 4A		 lsr @
    84 00,4210 AA		 tax
    85 00,4211 BD 97 47		 lda tab1,x
    86 00,4214 8D 33 42		 sta zm1+1
    87 00,4217 BD 98 47		 lda tab1+1,x
    88 00,421A 8D 34 42		 sta zm1+2
    89 00,421D A9 03		 lda #3
    90 00,421F 8D 0F D2		 sta $d20f
    91 00,4222 D8		 cld
    92 00,4223 A5 FE		 lda word
    93 00,4225 48		 pha
    94 00,4226 A5 FF		 lda word+1
    95 00,4228 48		 pha
    96 00,4229 AC FA 41		 ldy b3
    97 00,422C AE F9 41		 ldx b2
    98 00,422F AD F8 41		 lda b1
    99 00,4232 20 3C 42		zm1 jsr graj
   100 00,4235 68		 pla
   101 00,4236 85 FF		 sta word+1
   102 00,4238 68		 pla
   103 00,4239 85 FE		 sta word
   104 00,423B 60		 rts
   105
   106 00,423C AD 00 42		graj lda adrsng
   107 00,423F 85 FE		 sta word
   108 00,4241 AD 01 42		 lda adrsng+1
   109 00,4244 85 FF		 sta word+1
   110 00,4246 A0 00		 ldy #0
   111 00,4248 8A		 txa
   112 00,4249 F0 1C		 beq grajx
   113 00,424B B1 FE		l1 lda (word),y
   114 00,424D C9 8F		 cmp #$8f
   115 00,424F F0 04		 beq l2
   116 00,4251 C9 EF		 cmp #$ef
   117 00,4253 D0 0C		 bne l3
   118 00,4255 CA		l2 dex
   119 00,4256 D0 09		 bne l3
   120 00,4258 C8		 iny
   121 00,4259 C0 54		 cpy #$54
   122 00,425B B0 09		 bcs l4
   123 00,425D 98		 tya
   124 00,425E AA		 tax
   125 00,425F 10 06		 bpl grajx
   126 00,4261 C8		l3 iny
   127 00,4262 C0 54		 cpy #$54
   128 00,4264 90 E5		 bcc l1
   129 00,4266 60		l4 rts
   130
   131 00,4267 8E F2 41		grajx stx possng
   132 00,426A 20 05 43		 jsr skoncz
   133 00,426D A9 00		 lda #0
   134 00,426F A2 09		 ldx #9
   135 00,4271 9D CF 41		l5 sta poswpt,x
   136 00,4274 CA		 dex
   137 00,4275 10 FA		 bpl l5
   138 00,4277 8D F1 41		 sta posptr
   139 00,427A A9 01		 lda #1
   140 00,427C 8D FB 41		 sta czygr
   141 00,427F A9 FF		 lda #$ff
   142 00,4281 8D F4 41		 sta konrep
   143 00,4284 AD FC 41		 lda adrmus
   144 00,4287 85 FE		 sta word
   145 00,4289 AD FD 41		 lda adrmus+1
   146 00,428C 85 FF		 sta word+1
   147 00,428E A0 13		 ldy #$13
   148 00,4290 B1 FE		 lda (word),y
   149 00,4292 AA		 tax
   150 00,4293 AD 00 42		 lda adrsng
   151 00,4296 85 FE		 sta word
   152 00,4298 AD 01 42		 lda adrsng+1
   153 00,429B 85 FF		 sta word+1
   154 00,429D AC F2 41		 ldy possng
   155 00,42A0 B1 FE		l6 lda (word),y
   156 00,42A2 C9 CF		 cmp #$cf
   157 00,42A4 D0 0D		 bne l7
   158 00,42A6 98		 tya
   159 00,42A7 18		 clc
   160 00,42A8 69 55		 adc #$55
   161 00,42AA A8		 tay
   162 00,42AB B1 FE		 lda (word),y
   163 00,42AD 30 0F		 bmi l8
   164 00,42AF AA		 tax
   165 00,42B0 4C BE 42		 jmp l8
   166 00,42B3 C9 8F		l7 cmp #$8f
   167 00,42B5 F0 07		 beq l8
   168 00,42B7 C9 EF		 cmp #$ef
   169 00,42B9 F0 03		 beq l8
   170 00,42BB 88		 dey
   171 00,42BC 10 E2		 bpl l6
   172 00,42BE 8E F6 41		l8 stx tmpo
   173 00,42C1 8E F7 41		 stx ltemp
   174 00,42C4 60		 rts
   175
   176 00,42C5 29 0F		tempo and #$f
   177 00,42C7 F0 F5		 beq l8
   178 00,42C9 8E 62 47		 stx d0+1
   179 00,42CC 8E 78 47		 stx d1+1
   180 00,42CF 8E 87 47		 stx d2+1
   181 00,42D2 8C 63 47		 sty d0+2
   182 00,42D5 8C 79 47		 sty d1+2
   183 00,42D8 8C 88 47		 sty d2+2
   184 00,42DB 60		 rts
   185
   186 00,42DC 8E FC 41		inic stx adrmus
   187 00,42DF 86 FE		 stx word
   188 00,42E1 8C FD 41		 sty adrmus+1
   189 00,42E4 84 FF		 sty word+1
   190 00,42E6 18		 clc
   191 00,42E7 8A		 txa
   192 00,42E8 69 14		 adc #$14
   193 00,42EA 8D FE 41		 sta adradr
   194 00,42ED 98		 tya
   195 00,42EE 69 00		 adc #0
   196 00,42F0 8D FF 41		 sta adradr+1
   197 00,42F3 8E 00 42		 stx adrsng
   198 00,42F6 C8		 iny
   199 00,42F7 C8		 iny
   200 00,42F8 8C 01 42		 sty adrsng+1
   201 00,42FB A0 13		 ldy #$13
   202 00,42FD B1 FE		 lda (word),y
   203 00,42FF 8D F6 41		 sta tmpo
   204 00,4302 8D F7 41		 sta ltemp
   205
   206 00,4305 A2 08		skoncz ldx #8
   207 00,4307 A9 00		l9 lda #0
   208 00,4309 8D FB 41		 sta czygr
   209 00,430C 9D 00 D2		 sta $d200,x
   210 00,430F E0 03		 cpx #3
   211 00,4311 B0 08		 bcs l10
   212 00,4313 9D A5 41		 sta volume,x
   213 00,4316 A9 FF		 lda #$ff
   214 00,4318 9D C3 41		 sta count1,x
   215 00,431B CA		l10 dex
   216 00,431C 10 E9		 bpl l9
   217
   218 00,431E A9 80		przer lda #$80
   219 00,4320 A2 03		l11 ldx #3
   220 00,4322 9D D5 41		l12 sta czygrx,x
   221 00,4325 CA		 dex
   222 00,4326 10 FA		 bpl l12
   223 00,4328 60		l13 rts
   224
   225 00,4329 A9 01		kont lda #1
   226 00,432B 8D FB 41		 sta czygr
   227 00,432E A9 00		 lda #0
   228 00,4330 F0 EE		 beq l11
   229
   230 00,4332 29 03		instr and #3
   231 00,4334 C9 03		 cmp #3
   232 00,4336 F0 F0		 beq l13
   233 00,4338 E0 40		 cpx #$40
   234 00,433A B0 EC		 bcs l13
   235 00,433C C0 1A		 cpy #26
   236 00,433E B0 E8		 bcs l13
   237 00,4340 AA		 tax
   238 00,4341 A9 80		 lda #$80
   239 00,4343 9D D5 41		 sta czygrx,x
   240
   241 00,4346 A9 00		inst lda #0
   242 00,4348 9D C3 41		 sta count1,x
   243 00,434B 9D C6 41		 sta count2,x
   244 00,434E 9D C9 41		 sta lopad,x
   245 00,4351 AD F9 41		 lda b2
   246 00,4354 9D A8 41		 sta czest,x
   247
   248 00,4357 AD FA 41		 lda b3
   249 00,435A 0A		 asl @
   250 00,435B 0A		 asl @
   251 00,435C 0A		 asl @
   252 00,435D 85 FE		 sta word
   253 00,435F 18		 clc
   254 00,4360 AD FC 41		 lda adrmus
   255 00,4363 69 30		 adc #$30
   256 00,4365 48		 pha
   257 00,4366 AD FD 41		 lda adrmus+1
   258 00,4369 69 01		 adc #1
   259 00,436B A8		 tay
   260 00,436C 68		 pla
   261 00,436D 18		 clc
   262 00,436E 65 FE		 adc word
   263 00,4370 9D EB 41		 sta ladr,x
   264 00,4373 98		 tya
   265 00,4374 69 00		 adc #0
   266 00,4376 9D EE 41		 sta hadr,x
   267
   268 00,4379 18		 clc
   269 00,437A AD FC 41		 lda adrmus
   270 00,437D 69 94		 adc #$94
   271 00,437F 85 FE		 sta word
   272 00,4381 AD FD 41		 lda adrmus+1
   273 00,4384 69 00		 adc #0
   274 00,4386 85 FF		 sta word+1
   275 00,4388 AD FA 41		 lda b3
   276 00,438B 0A		 asl @
   277 00,438C 6D FA 41		 adc b3
   278 00,438F 0A		 asl @
   279 00,4390 A8		 tay
   280 00,4391 B1 FE		 lda (word),y
   281 00,4393 9D D9 41		 sta dana0,x
   282 00,4396 C8		 iny
   283 00,4397 B1 FE		 lda (word),y
   284 00,4399 9D DC 41		 sta dana1,x
   285 00,439C 29 07		 and #7
   286 00,439E 8D F8 41		 sta b1
   287 00,43A1 C8		 iny
   288 00,43A2 B1 FE		 lda (word),y
   289 00,43A4 9D DF 41		 sta dana2,x
   290 00,43A7 C8		 iny
   291 00,43A8 B1 FE		 lda (word),y
   292 00,43AA 9D E2 41		 sta dana3,x
   293 00,43AD C8		 iny
   294 00,43AE B1 FE		 lda (word),y
   295 00,43B0 9D E5 41		 sta dana4,x
   296 00,43B3 C8		 iny
   297 00,43B4 B1 FE		 lda (word),y
   298 00,43B6 9D E8 41		 sta dana5,x
   299
   300 00,43B9 A0 00		 ldy #0
   301 00,43BB AD F8 41		 lda b1
   302 00,43BE C9 03		 cmp #3
   303 00,43C0 D0 02		 bne l14
   304 00,43C2 A0 02		 ldy #2
   305 00,43C4 C9 07		l14 cmp #7
   306 00,43C6 D0 02		 bne l15
   307 00,43C8 A0 04		 ldy #4
   308 00,43CA B9 B5 47		l15 lda tab3,y
   309 00,43CD 85 FE		 sta word
   310 00,43CF B9 B6 47		 lda tab3+1,y
   311 00,43D2 85 FF		 sta word+1
   312 00,43D4 BD DF 41		 lda dana2,x
   313 00,43D7 4A		 lsr @
   314 00,43D8 4A		 lsr @
   315 00,43D9 4A		 lsr @
   316 00,43DA 4A		 lsr @
   317 00,43DB 18		 clc
   318 00,43DC 6D F9 41		 adc b2
   319 00,43DF 8D F9 41		 sta b2
   320 00,43E2 8D 4C 44		 sta zm2+1
   321 00,43E5 A8		 tay
   322 00,43E6 AD F8 41		 lda b1
   323 00,43E9 C9 07		 cmp #7
   324 00,43EB D0 0F		 bne l16
   325 00,43ED 98		 tya
   326 00,43EE 0A		 asl @
   327 00,43EF A8		 tay
   328 00,43F0 B1 FE		 lda (word),y
   329 00,43F2 9D B7 41		 sta czest1,x
   330 00,43F5 C8		 iny
   331 00,43F6 8C F9 41		 sty b2
   332 00,43F9 4C 0D 44		 jmp l17
   333 00,43FC B1 FE		l16 lda (word),y
   334 00,43FE 9D B7 41		 sta czest1,x
   335 00,4401 BD DF 41		 lda dana2,x
   336 00,4404 29 0F		 and #$f
   337 00,4406 18		 clc
   338 00,4407 6D F9 41		 adc b2
   339 00,440A 8D F9 41		 sta b2
   340 00,440D AC F9 41		l17 ldy b2
   341 00,4410 AD F8 41		 lda b1
   342 00,4413 C9 05		 cmp #5
   343 00,4415 08		 php
   344 00,4416 B1 FE		 lda (word),y
   345 00,4418 28		 plp
   346 00,4419 F0 08		 beq l18
   347 00,441B DD B7 41		 cmp czest1,x
   348 00,441E D0 03		 bne l18
   349 00,4420 38		 sec
   350 00,4421 E9 01		 sbc #1
   351 00,4423 9D BA 41		l18 sta czest2,x
   352 00,4426 BD D9 41		 lda dana0,x
   353 00,4429 48		 pha
   354 00,442A 29 03		 and #3
   355 00,442C A8		 tay
   356 00,442D B9 BB 47		 lda tab4,y
   357 00,4430 9D C0 41		 sta zniek,x
   358 00,4433 68		 pla
   359 00,4434 4A		 lsr @
   360 00,4435 4A		 lsr @
   361 00,4436 4A		 lsr @
   362 00,4437 4A		 lsr @
   363 00,4438 A0 3E		 ldy #$3e
   364 00,443A C9 0F		 cmp #$f
   365 00,443C F0 10		 beq l19
   366 00,443E A0 37		 ldy #$37
   367 00,4440 C9 0E		 cmp #$e
   368 00,4442 F0 0A		 beq l19
   369 00,4444 A0 30		 ldy #$30
   370 00,4446 C9 0D		 cmp #$d
   371 00,4448 F0 04		 beq l19
   372 00,444A 18		 clc
   373 00,444B 69 00		zm2 adc #0
   374 00,444D A8		 tay
   375 00,444E B9 BF 47		l19 lda tab5,y
   376 00,4451 9D BD 41		 sta czest3,x
   377 00,4454 60		 rts
   378
   379 				*--- play
   380
   381 00,4455 D8		play cld
   382 00,4456 A5 FC		 lda addr
   383 00,4458 48		 pha
   384 00,4459 A5 FD		 lda addr+1
   385 00,445B 48		 pha
   386 00,445C A5 FE		 lda word
   387 00,445E 48		 pha
   388 00,445F A5 FF		 lda word+1
   389 00,4461 48		 pha
   390 00,4462 AD FB 41		 lda czygr
   391 00,4465 D0 03		 bne g1
   392 00,4467 4C 8A 47		 jmp end
   393 00,446A AD D8 41		g1 lda czygrc
   394 00,446D F0 03		 beq g2
   395 00,446F 4C F3 45		 jmp dal3
   396 00,4472 AD F6 41		g2 lda tmpo
   397 00,4475 CD F7 41		 cmp ltemp
   398 00,4478 F0 03		 beq g3
   399 00,447A 4C E0 45		 jmp dal2
   400 00,447D AD F1 41		g3 lda posptr
   401 00,4480 F0 03		 beq g4
   402 00,4482 4C 66 45		 jmp dal1
   403 00,4485 A2 02		g4 ldx #2
   404 00,4487 BC D5 41		g5 ldy czygrx,x
   405 00,448A 30 03		 bmi g6
   406 00,448C 9D D5 41		 sta czygrx,x
   407 00,448F 9D CF 41		g6 sta poswpt,x
   408 00,4492 CA		 dex
   409 00,4493 10 F2		 bpl g5
   410
   411 00,4495 AD 00 42		 lda adrsng
   412 00,4498 85 FC		 sta addr
   413 00,449A AD 01 42		 lda adrsng+1
   414 00,449D 85 FD		 sta addr+1
   415 00,449F AC F2 41		 ldy possng
   416 00,44A2 84 FE		 sty word
   417 00,44A4 CC F4 41		g7 cpy konrep
   418 00,44A7 D0 19		 bne g8
   419 00,44A9 AD F5 41		 lda ilrep
   420 00,44AC F0 14		 beq g8
   421 00,44AE AD F2 41		 lda possng
   422 00,44B1 AC F3 41		 ldy pocrep
   423 00,44B4 8C F2 41		 sty possng
   424 00,44B7 CE F5 41		 dec ilrep
   425 00,44BA D0 E8		 bne g7
   426 00,44BC 8D F2 41		 sta possng
   427 00,44BF A8		 tay
   428 00,44C0 10 E2		 bpl g7
   429 00,44C2 A2 00		g8 ldx #0
   430 00,44C4 B1 FC		g9 lda (addr),y
   431 00,44C6 C9 FE		 cmp #$fe
   432 00,44C8 D0 0E		 bne g10
   433 00,44CA AC F2 41		 ldy possng
   434 00,44CD C8		 iny
   435 00,44CE C4 FE		 cpy word
   436 00,44D0 F0 43		 beq g11
   437 00,44D2 8C F2 41		 sty possng
   438 00,44D5 4C A4 44		 jmp g7
   439 00,44D8 9D CC 41		g10 sta numptr,x
   440 00,44DB 18		 clc
   441 00,44DC 98		 tya
   442 00,44DD 69 55		 adc #$55
   443 00,44DF A8		 tay
   444 00,44E0 E8		 inx
   445 00,44E1 E0 03		 cpx #3
   446 00,44E3 90 DF		 bcc g9
   447 00,44E5 AC F2 41		 ldy possng
   448 00,44E8 B1 FC		 lda (addr),y
   449 00,44EA 10 7A		 bpl dal1
   450 00,44EC C9 FF		 cmp #$ff
   451 00,44EE F0 76		 beq dal1
   452 00,44F0 4A		 lsr @
   453 00,44F1 4A		 lsr @
   454 00,44F2 4A		 lsr @
   455 00,44F3 29 0E		 and #$e
   456 00,44F5 AA		 tax
   457 00,44F6 BD A7 47		 lda tab2,x
   458 00,44F9 8D 08 45		 sta zm3+1
   459 00,44FC BD A8 47		 lda tab2+1,x
   460 00,44FF 8D 09 45		 sta zm3+2
   461 00,4502 AD CD 41		 lda numptr+1
   462 00,4505 85 FF		 sta word+1
   463 00,4507 20 1D 45		zm3 jsr stop
   464 00,450A 8C F2 41		 sty possng
   465 00,450D C0 55		 cpy #$55
   466 00,450F B0 04		 bcs g11
   467 00,4511 C4 FE		 cpy word
   468 00,4513 D0 8F		 bne g7
   469 00,4515 A4 FE		g11 ldy word
   470 00,4517 8C F2 41		 sty possng
   471 00,451A 4C 8A 47		 jmp end
   472
   473 00,451D 20 1E 43		stop jsr przer
   474 00,4520 A0 FF		g12 ldy #$ff
   475 00,4522 60		 rts
   476 00,4523 30 FB		jump bmi g12
   477 00,4525 A8		 tay
   478 00,4526 60		 rts
   479 00,4527 30 F7		up bmi g12
   480 00,4529 38		 sec
   481 00,452A 98		 tya
   482 00,452B E5 FF		 sbc word+1
   483 00,452D A8		 tay
   484 00,452E 60		 rts
   485 00,452F 30 EF		down bmi g12
   486 00,4531 18		 clc
   487 00,4532 98		 tya
   488 00,4533 65 FF		 adc word+1
   489 00,4535 A8		 tay
   490 00,4536 60		 rts
   491 00,4537 30 E7		temp bmi g12
   492 00,4539 8D F6 41		 sta tmpo
   493 00,453C 8D F7 41		 sta ltemp
   494 00,453F C8		 iny
   495 00,4540 60		 rts
   496 00,4541 30 DD		rep bmi g12
   497 00,4543 AD CE 41		 lda numptr+2
   498 00,4546 30 D8		 bmi g12
   499 00,4548 8D F5 41		 sta ilrep
   500 00,454B C8		 iny
   501 00,454C 8C F3 41		 sty pocrep
   502 00,454F 18		 clc
   503 00,4550 98		 tya
   504 00,4551 65 FF		 adc word+1
   505 00,4553 8D F4 41		 sta konrep
   506 00,4556 60		 rts
   507 00,4557 88		break dey
   508 00,4558 30 0A		 bmi g13
   509 00,455A B1 FC		 lda (addr),y
   510 00,455C C9 8F		 cmp #$8f
   511 00,455E F0 04		 beq g13
   512 00,4560 C9 EF		 cmp #$ef
   513 00,4562 D0 F3		 bne break
   514 00,4564 C8		g13 iny
   515 00,4565 60		 rts
   516
   517 00,4566 A2 02		dal1 ldx #2
   518 00,4568 BD D2 41		v1 lda ilewol,x
   519 00,456B F0 05		 beq v2
   520 00,456D DE D2 41		 dec ilewol,x
   521 00,4570 10 61		 bpl v7
   522 00,4572 BD D5 41		v2 lda czygrx,x
   523 00,4575 D0 5C		 bne v7
   524 00,4577 BC CC 41		 ldy numptr,x
   525 00,457A C0 40		 cpy #$40
   526 00,457C B0 55		 bcs v7
   527 00,457E AD FE 41		 lda adradr
   528 00,4581 85 FC		 sta addr
   529 00,4583 AD FF 41		 lda adradr+1
   530 00,4586 85 FD		 sta addr+1
   531 00,4588 B1 FC		 lda (addr),y
   532 00,458A 85 FE		 sta word
   533 00,458C 18		 clc
   534 00,458D 98		 tya
   535 00,458E 69 40		 adc #$40
   536 00,4590 A8		 tay
   537 00,4591 B1 FC		 lda (addr),y
   538 00,4593 85 FF		 sta word+1
   539 00,4595 C9 FF		 cmp #$ff
   540 00,4597 F0 3A		 beq v7
   541 00,4599 BC CF 41		v3 ldy poswpt,x
   542 00,459C B1 FE		 lda (word),y
   543 00,459E 29 C0		 and #$c0
   544 00,45A0 D0 0C		 bne v4
   545 00,45A2 B1 FE		 lda (word),y
   546 00,45A4 29 3F		 and #$3f
   547 00,45A6 9D AB 41		 sta numins,x
   548 00,45A9 FE CF 41		 inc poswpt,x
   549 00,45AC 10 EB		 bpl v3
   550 00,45AE C9 40		v4 cmp #$40
   551 00,45B0 D0 13		 bne v5
   552 00,45B2 B1 FE		 lda (word),y
   553 00,45B4 29 3F		 and #$3f
   554 00,45B6 8D F9 41		 sta b2
   555 00,45B9 BD AB 41		 lda numins,x
   556 00,45BC 8D FA 41		 sta b3
   557 00,45BF 20 46 43		 jsr inst
   558 00,45C2 4C D0 45		 jmp v6
   559 00,45C5 C9 80		v5 cmp #$80
   560 00,45C7 D0 0A		 bne v7
   561 00,45C9 B1 FE		 lda (word),y
   562 00,45CB 29 3F		 and #$3f
   563 00,45CD 9D D2 41		 sta ilewol,x
   564 00,45D0 FE CF 41		v6 inc poswpt,x
   565 00,45D3 CA		v7 dex
   566 00,45D4 10 92		 bpl v1
   567
   568 00,45D6 AE F1 41		 ldx posptr
   569 00,45D9 E8		 inx
   570 00,45DA 8A		 txa
   571 00,45DB 29 3F		 and #$3f
   572 00,45DD 8D F1 41		 sta posptr
   573
   574 00,45E0 CE F7 41		dal2 dec ltemp
   575 00,45E3 D0 0E		 bne dal3
   576 00,45E5 AD F6 41		 lda tmpo
   577 00,45E8 8D F7 41		 sta ltemp
   578 00,45EB AD F1 41		 lda posptr
   579 00,45EE D0 03		 bne dal3
   580 00,45F0 EE F2 41		 inc possng
   581
   582 00,45F3 AC BA 41		dal3 ldy czest2
   583 00,45F6 AD DC 41		 lda dana1
   584 00,45F9 29 07		 and #7
   585 00,45FB C9 05		 cmp #5
   586 00,45FD F0 04		 beq a1
   587 00,45FF C9 06		 cmp #6
   588 00,4601 D0 01		 bne a2
   589 00,4603 88		a1 dey
   590 00,4604 8C B1 41		a2 sty frq+3
   591 00,4607 A0 00		 ldy #0
   592 00,4609 C9 05		 cmp #5
   593 00,460B F0 04		 beq a3
   594 00,460D C9 06		 cmp #6
   595 00,460F D0 02		 bne a4
   596 00,4611 A0 02		a3 ldy #2
   597 00,4613 C9 07		a4 cmp #7
   598 00,4615 D0 02		 bne a5
   599 00,4617 A0 28		 ldy #$28
   600 00,4619 8C B6 41		a5 sty audc
   601
   602 00,461C A2 02		 ldx #2
   603 00,461E BD DC 41		loop lda dana1,x
   604 00,4621 29 E0		 and #$e0
   605 00,4623 9D B2 41		 sta znieks,x
   606 00,4626 BD EB 41		 lda ladr,x
   607 00,4629 85 FC		 sta addr
   608 00,462B BD EE 41		 lda hadr,x
   609 00,462E 85 FD		 sta addr+1
   610 00,4630 BD C3 41		 lda count1,x
   611 00,4633 C9 FF		 cmp #$ff
   612 00,4635 F0 36		 beq y4
   613 00,4637 C9 0F		 cmp #$f
   614 00,4639 D0 20		 bne y2
   615 00,463B BD C9 41		 lda lopad,x
   616 00,463E F0 2D		 beq y4
   617 00,4640 DE C9 41		 dec lopad,x
   618 00,4643 BD C9 41		 lda lopad,x
   619 00,4646 D0 25		 bne y4
   620 00,4648 BC A5 41		 ldy volume,x
   621 00,464B F0 01		 beq y1
   622 00,464D 88		 dey
   623 00,464E 98		y1 tya
   624 00,464F 9D A5 41		 sta volume,x
   625 00,4652 BD E2 41		 lda dana3,x
   626 00,4655 9D C9 41		 sta lopad,x
   627 00,4658 4C 6D 46		 jmp y4
   628 00,465B BD C3 41		y2 lda count1,x
   629 00,465E 4A		 lsr @
   630 00,465F A8		 tay
   631 00,4660 B1 FC		 lda (addr),y
   632 00,4662 90 04		 bcc y3
   633 00,4664 4A		 lsr @
   634 00,4665 4A		 lsr @
   635 00,4666 4A		 lsr @
   636 00,4667 4A		 lsr @
   637 00,4668 29 0F		y3 and #$f
   638 00,466A 9D A5 41		 sta volume,x
   639 00,466D BC B7 41		y4 ldy czest1,x
   640 00,4670 BD DC 41		 lda dana1,x
   641 00,4673 29 07		 and #7
   642 00,4675 C9 01		 cmp #1
   643 00,4677 D0 1F		 bne y6
   644 00,4679 88		 dey
   645 00,467A 98		 tya
   646 00,467B C8		 iny
   647 00,467C DD BA 41		 cmp czest2,x
   648 00,467F 08		 php
   649 00,4680 A9 01		 lda #1
   650 00,4682 28		 plp
   651 00,4683 D0 02		 bne y5
   652 00,4685 0A		 asl @
   653 00,4686 0A		 asl @
   654 00,4687 3D C6 41		y5 and count2,x
   655 00,468A F0 0C		 beq y6
   656 00,468C BC BA 41		 ldy czest2,x
   657 00,468F C0 FF		 cpy #$ff
   658 00,4691 D0 05		 bne y6
   659 00,4693 A9 00		 lda #0
   660 00,4695 9D A5 41		 sta volume,x
   661 00,4698 98		y6 tya
   662 00,4699 9D AE 41		 sta frq,x
   663 00,469C A9 01		 lda #1
   664 00,469E 8D F8 41		 sta b1
   665 00,46A1 BD C3 41		 lda count1,x
   666 00,46A4 C9 0F		 cmp #$f
   667 00,46A6 F0 38		 beq y9
   668 00,46A8 29 07		 and #7
   669 00,46AA A8		 tay
   670 00,46AB B9 D3 48		 lda tab9,y
   671 00,46AE 85 FE		 sta word
   672 00,46B0 BD C3 41		 lda count1,x
   673 00,46B3 29 08		 and #8
   674 00,46B5 08		 php
   675 00,46B6 8A		 txa
   676 00,46B7 28		 plp
   677 00,46B8 18		 clc
   678 00,46B9 F0 02		 beq y7
   679 00,46BB 69 03		 adc #3
   680 00,46BD A8		y7 tay
   681 00,46BE B9 E5 41		 lda dana4,y
   682 00,46C1 25 FE		 and word
   683 00,46C3 F0 1B		 beq y9
   684 00,46C5 BD BD 41		 lda czest3,x
   685 00,46C8 9D AE 41		 sta frq,x
   686 00,46CB 8E F8 41		 stx b1
   687 00,46CE CA		 dex
   688 00,46CF 10 08		 bpl y8
   689 00,46D1 8D B1 41		 sta frq+3
   690 00,46D4 A9 00		 lda #0
   691 00,46D6 8D B6 41		 sta audc
   692 00,46D9 E8		y8 inx
   693 00,46DA BD C0 41		 lda zniek,x
   694 00,46DD 9D B2 41		 sta znieks,x
   695 00,46E0 BD C3 41		y9 lda count1,x
   696 00,46E3 29 0F		 and #$f
   697 00,46E5 C9 0F		 cmp #$f
   698 00,46E7 F0 10		 beq y10
   699 00,46E9 FE C3 41		 inc count1,x
   700 00,46EC BD C3 41		 lda count1,x
   701 00,46EF C9 0F		 cmp #$f
   702 00,46F1 D0 06		 bne y10
   703 00,46F3 BD E2 41		 lda dana3,x
   704 00,46F6 9D C9 41		 sta lopad,x
   705 00,46F9 BD D5 41		y10 lda czygrx,x
   706 00,46FC 10 0A		 bpl y11
   707 00,46FE BD A5 41		 lda volume,x
   708 00,4701 D0 05		 bne y11
   709 00,4703 A9 40		 lda #$40
   710 00,4705 9D D5 41		 sta czygrx,x
   711 00,4708 FE C6 41		y11 inc count2,x
   712 00,470B A0 00		 ldy #0
   713 00,470D BD DC 41		 lda dana1,x
   714 00,4710 4A		 lsr @
   715 00,4711 4A		 lsr @
   716 00,4712 4A		 lsr @
   717 00,4713 4A		 lsr @
   718 00,4714 90 01		 bcc y12
   719 00,4716 88		 dey
   720 00,4717 4A		y12 lsr @
   721 00,4718 90 01		 bcc y13
   722 00,471A C8		 iny
   723 00,471B 18		y13 clc
   724 00,471C 98		 tya
   725 00,471D 7D B7 41		 adc czest1,x
   726 00,4720 9D B7 41		 sta czest1,x
   727 00,4723 BD BA 41		 lda czest2,x
   728 00,4726 C9 FF		 cmp #$ff
   729 00,4728 D0 02		 bne y14
   730 00,472A A0 00		 ldy #0
   731 00,472C 18		y14 clc
   732 00,472D 98		 tya
   733 00,472E 7D BA 41		 adc czest2,x
   734 00,4731 9D BA 41		 sta czest2,x
   735 00,4734 CA		 dex
   736 00,4735 30 03		 bmi x1
   737 00,4737 4C 1E 46		 jmp loop
   738
   739 00,473A AD B2 41		x1 lda znieks
   740 00,473D 8D B5 41		 sta znieks+3
   741 00,4740 AD DC 41		 lda dana1
   742 00,4743 29 07		 and #7
   743 00,4745 AA		 tax
   744 00,4746 A0 03		 ldy #3
   745 00,4748 AD F8 41		 lda b1
   746 00,474B F0 03		 beq x2
   747 00,474D BC DB 48		 ldy tab10,x
   748 00,4750 98		x2 tya
   749 00,4751 48		 pha
   750 00,4752 B9 BF 48		 lda tab8,y
   751 00,4755 08		 php
   752 00,4756 29 7F		 and #$7f
   753 00,4758 AA		 tax
   754 00,4759 98		 tya
   755 00,475A 29 03		 and #3
   756 00,475C 0A		 asl @
   757 00,475D A8		 tay
   758 00,475E BD AE 41		 lda frq,x
   759 00,4761 99 00 D2		d0 sta $d200,y
   760 00,4764 C8		 iny
   761 00,4765 BD A5 41		 lda volume,x
   762 00,4768 E0 03		 cpx #3
   763 00,476A D0 03		 bne x3
   764 00,476C AD A5 41		 lda volume
   765 00,476F 1D B2 41		x3 ora znieks,x
   766 00,4772 28		 plp
   767 00,4773 10 02		 bpl d1
   768 00,4775 A9 00		 lda #0
   769 00,4777 99 00 D2		d1 sta $d200,y
   770 00,477A 68		 pla
   771 00,477B A8		 tay
   772 00,477C 88		 dey
   773 00,477D 29 03		 and #3
   774 00,477F D0 CF		 bne x2
   775 00,4781 A0 08		 ldy #8
   776 00,4783 AD B6 41		 lda audc
   777 00,4786 99 00 D2		d2 sta $d200,y
   778
   779 00,4789 18		 clc
   780 00,478A 68		end pla
   781 00,478B 85 FF		 sta word+1
   782 00,478D 68		 pla
   783 00,478E 85 FE		 sta word
   784 00,4790 68		 pla
   785 00,4791 85 FD		 sta addr+1
   786 00,4793 68		 pla
   787 00,4794 85 FC		 sta addr
   788 00,4796 60		 rts
   789
   790 				*--- basic
   791 				/*
   792 				basic pla
   793 				 tax
   794 				 beq p6
   795 				 cmp #2
   796 				 beq p2
   797 				p1 pla
   798 				 pla
   799 				 dex
   800 				 bne p1
   801 				 rts
   802
   803 				p2 lda $14
   804 				 cmp $14
   805 				 beq *-2
   806
   807 				 lda $224
   808 				 cmp <p8
   809 				 bne p3
   810 				 lda $225
   811 				 cmp >p8
   812 				 beq p1
   813 				p3 lda $224
   814 				 sta p9+1
   815 				 lda $225
   816 				 sta p9+2
   817 				 lda <p8
   818 				 sta $224
   819 				 lda >p8
   820 				 sta $225
   821 				 pla
   822 				 pla
   823 				 beq p4
   824 				 sec
   825 				 sbc #1
   826 				p4 sta p5+1
   827 				 pla
   828 				 tay
   829 				 pla
   830 				 tax
   831 				 lda #$70
   832 				 jsr init
   833 				 lda #0
   834 				p5 ldx #0
   835 				 jmp init
   836 				p6 lda $14
   837 				 cmp $14
   838 				 beq *-2
   839 				 lda $224
   840 				 cmp <p8
   841 				 bne p2-1
   842 				 lda $225
   843 				 cmp >p8
   844 				 bne p2-1
   845 				p7 lda p9+1
   846 				 sta $224
   847 				 lda p9+2
   848 				 sta $225
   849 				 lda #$40
   850 				 jmp init
   851 				p8 jsr play
   852 				 bcc p9
   853 				 jsr p7
   854 				p9 jmp $ffff
   855 				*/
   856
   857 				*--- tablice
   858
   859 00,4797 3C 42		tab1 dta a(graj)
   860 00,4799 67 42		 dta a(grajx)
   861 00,479B 32 43		 dta a(instr)
   862 00,479D C5 42		 dta a(tempo)
   863 00,479F 05 43		 dta a(skoncz)
   864 00,47A1 1E 43		 dta a(przer)
   865 00,47A3 29 43		 dta a(kont)
   866 00,47A5 DC 42		 dta a(inic)
   867
   868 00,47A7 1D 45		tab2 dta a(stop)
   869 00,47A9 23 45		 dta a(jump)
   870 00,47AB 27 45		 dta a(up)
   871 00,47AD 2F 45		 dta a(down)
   872 00,47AF 37 45		 dta a(temp)
   873 00,47B1 41 45		 dta a(rep)
   874 00,47B3 57 45		 dta a(break)
   875
   876 00,47B5 BF 47		tab3 dta a(tab5)
   877 00,47B7 00 48		 dta a(tab6)
   878 00,47B9 41 48		 dta a(tab7)
   879
   880 00,47BB 80 A0		tab4 dta b($80),b($a0)
   881 00,47BD 20 40		 dta b($20),b($40)
   882
   883 00,47BF FF F1 E4 D7	tab5 dta b($ff),b($f1),b($e4),b($d7)
   884 00,47C3 CB C0 B5 AA	 dta b($cb),b($c0),b($b5),b($aa)
   885 00,47C7 A1 98 8F 87	 dta b($a1),b($98),b($8f),b($87)
   886 00,47CB 7F 78 72 6B	 dta b($7f),b($78),b($72),b($6b)
   887 00,47CF 65 5F 5A 55	 dta b($65),b($5f),b($5a),b($55)
   888 00,47D3 50 4B 47 43	 dta b($50),b($4b),b($47),b($43)
   889 00,47D7 3F 3C 38 35	 dta b($3f),b($3c),b($38),b($35)
   890 00,47DB 32 2F 2C 2A	 dta b($32),b($2f),b($2c),b($2a)
   891 00,47DF 27 25 23 21	 dta b($27),b($25),b($23),b($21)
   892 00,47E3 1F 1D 1C 1A	 dta b($1f),b($1d),b($1c),b($1a)
   893 00,47E7 18 17 16 14	 dta b($18),b($17),b($16),b($14)
   894 00,47EB 13 12 11 10	 dta b($13),b($12),b($11),b($10)
   895 00,47EF 0F 0E 0D 0C	 dta b($0f),b($0e),b($0d),b($0c)
   896 00,47F3 0B 0A 09 08	 dta b($0b),b($0a),b($09),b($08)
   897 00,47F7 07 06 05 04	 dta b($07),b($06),b($05),b($04)
   898 00,47FB 03 02 01 00	 dta b($03),b($02),b($01),b($00)
   899 00,47FF 00		 dta b($00)
   900
   901 00,4800			tab6
   902
   903 				 ift bass=0
   904
   905 				 dta b($00),b($00),b($00),b($00)
   906 				 dta b($f2),b($e9),b($da),b($ce)
   907 				 dta b($bf),b($b6),b($aa),b($a1)
   908 				 dta b($98),b($8f),b($89),b($80)
   909 				 dta b($7a),b($71),b($6b),b($65)
   910 				 dta b($5f),b($00),b($56),b($50)
   911 				 dta b($67),b($60),b($5a),b($55)
   912 				 dta b($51),b($4c),b($48),b($43)
   913 				 dta b($3f),b($3d),b($39),b($34)
   914 				 dta b($33),b($39),b($2d),b($2a)
   915 				 dta b($28),b($25),b($24),b($21)
   916 				 dta b($1f),b($1e),b($00),b($00)
   917 				 dta b($0f),b($0e),b($0d),b($0c)
   918 				 dta b($0b),b($0a),b($09),b($08)
   919 				 dta b($07),b($06),b($05),b($04)
   920 				 dta b($03),b($02),b($01),b($00)
   921 				 dta b($00)
   922
   923 				 els
   924
   925 00,4800 00 00 00 00 F2 +	 dta 0,0,0,0,242,233,218,206,191,182,170,161
   926 00,480C 98 8F 89 80 7A +	 dta 152,143,137,128,122,113,107,101,95,92,86
   927 00,4817 50 4D 47 44 41 +	 dta 80,77,71,68,65,62,56,53,136,127,121,115,108
   928 00,4824 67 60 5A 55 51 +	 dta 103,96,90,85,81,76,72,67,63,61,57,52,51,48
   929 00,4832 2D 2A 28 25 24 +	 dta 45,42,40,37,36,33,31,30,5,4,3,2,1,0,0
   930
   931 				 eif
   932
   933 00,4841 38 0B 8C 0A 00 +	tab7 dta a($b38),a($a8c),a($a00),a($96a)
   934 00,4849 E8 08 6A 08 EF +	 dta a($8e8),a($86a),a($7ef),a($780)
   935 00,4851 08 07 AE 06 46 +	 dta a($708),a($6ae),a($646),a($5e6)
   936 00,4859 95 05 41 05 F6 +	 dta a($595),a($541),a($4f6),a($4b0)
   937 00,4861 6E 04 30 04 F6 +	 dta a($46e),a($430),a($3f6),a($3bb)
   938 00,4869 84 03 52 03 22 +	 dta a($384),a($352),a($322),a($2f4)
   939 00,4871 C8 02 A0 02 7A +	 dta a($2c8),a($2a0),a($27a),a($255)
   940 00,4879 34 02 14 02 F5 +	 dta a($234),a($214),a($1f5),a($1d8)
   941 00,4881 BD 01 A4 01 8D +	 dta a($1bd),a($1a4),a($18d),a($177)
   942 00,4889 60 01 4E 01 38 +	 dta a($160),a($14e),a($138),a($127)
   943 00,4891 15 01 06 01 F7 +	 dta a($115),a($106),a($0f7),a($0e8)
   944 00,4899 DB 00 CF 00 C3 +	 dta a($0db),a($0cf),a($0c3),a($0b8)
   945 00,48A1 AC 00 A2 00 9A +	 dta a($0ac),a($0a2),a($09a),a($090)
   946 00,48A9 88 00 7F 00 78 +	 dta a($088),a($07f),a($078),a($070)
   947 00,48B1 6A 00 64 00 5E +	 dta a($06a),a($064),a($05e),a($057)
   948 00,48B9 52 00 32 00 0A +	 dta a($052),a($032),a($00a)
   949
   950 00,48BF 00 01 02 83	tab8 dta b($00),b($01),b($02),b($83)
   951 00,48C3 00 01 02 03	 dta b($00),b($01),b($02),b($03)
   952 00,48C7 01 00 02 83	 dta b($01),b($00),b($02),b($83)
   953 00,48CB 01 00 02 03	 dta b($01),b($00),b($02),b($03)
   954 00,48CF 01 02 80 03	 dta b($01),b($02),b($80),b($03)
   955
   956 00,48D3 80 40 20 10	tab9 dta b($80),b($40),b($20),b($10)
   957 00,48D7 08 04 02 01	 dta b($08),b($04),b($02),b($01)
   958
   959 00,48DB 03 03 03 03	tab10 dta b(3),b(3),b(3),b(3)
   960 00,48DF 07 0B 0F 13	 dta b(7),b($b),b($f),b($13)
   961
   962 				*--- koniec
   963
   964 				.endp
  1295
  1296 				.endl
  1297
  1298
  1299 00,48E3			reset_pokey
  1300 00,48E3 A0 08		 ldy #8			;muza stop
  1301 00,48E5 A9 00		 lda #0
  1302 00,48E7			sil
  1303 00,48E7 99 00 D2		 sta $d200,y
  1304 00,48EA 99 10 D2		 sta $d210,y
  1305 00,48ED 88		 dey
  1306 00,48EE 10 F7		 bpl sil
  1307
  1308 00,48F0 A9 03		 lda #3
  1309 00,48F2 8D 0F D2		 sta $d20f
  1310 00,48F5 8D 1F D2		 sta $d21f
  1311 00,48F8 60		 rts
  1312
  1313 				;--
  1314 00,02E0-02E1> 01 26	 run main
  1315
Source: D:\!Atari\getris2\grat\msx_cmc\cmc_relocator.mac
